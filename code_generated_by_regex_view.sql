select meta_query from dev.meta_col_datatype_v2 where table_name  = 'qe_raw_event';

drop table tmp.sfdc_event_meta;

select * into tmp.sfdc_event_meta from (
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 1 "position", 'Id' column_name, count(1) cnt, max(length(Id::varchar)) max_col_len, case when max(length(Id::varchar)) < 20 then 20 when max(length(Id::varchar)) between 21 and 40 then 50 when max(length(Id::varchar)) between 41 and 70 then 100 when max(length(Id::varchar)) between 71 and 200 then 250 when max(length(Id::varchar)) between 201 and 400 then 500 when max(length(Id::varchar)) between 401 and 700 then 1000 when max(length(Id::varchar)) between 701 and 1700 then 2000 when max(length(Id::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Id,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Id,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Id,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Id,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Id,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Id,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Id,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Id,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Id) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Id is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 2 "position", 'RecordTypeId' column_name, count(1) cnt, max(length(RecordTypeId::varchar)) max_col_len, case when max(length(RecordTypeId::varchar)) < 20 then 20 when max(length(RecordTypeId::varchar)) between 21 and 40 then 50 when max(length(RecordTypeId::varchar)) between 41 and 70 then 100 when max(length(RecordTypeId::varchar)) between 71 and 200 then 250 when max(length(RecordTypeId::varchar)) between 201 and 400 then 500 when max(length(RecordTypeId::varchar)) between 401 and 700 then 1000 when max(length(RecordTypeId::varchar)) between 701 and 1700 then 2000 when max(length(RecordTypeId::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecordTypeId,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecordTypeId,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecordTypeId,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecordTypeId,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecordTypeId,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecordTypeId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecordTypeId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecordTypeId,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecordTypeId) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecordTypeId is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 3 "position", 'WhoId' column_name, count(1) cnt, max(length(WhoId::varchar)) max_col_len, case when max(length(WhoId::varchar)) < 20 then 20 when max(length(WhoId::varchar)) between 21 and 40 then 50 when max(length(WhoId::varchar)) between 41 and 70 then 100 when max(length(WhoId::varchar)) between 71 and 200 then 250 when max(length(WhoId::varchar)) between 201 and 400 then 500 when max(length(WhoId::varchar)) between 401 and 700 then 1000 when max(length(WhoId::varchar)) between 701 and 1700 then 2000 when max(length(WhoId::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(WhoId,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(WhoId,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(WhoId,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(WhoId,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(WhoId,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(WhoId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(WhoId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(WhoId,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(WhoId) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN WhoId is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 4 "position", 'WhatId' column_name, count(1) cnt, max(length(WhatId::varchar)) max_col_len, case when max(length(WhatId::varchar)) < 20 then 20 when max(length(WhatId::varchar)) between 21 and 40 then 50 when max(length(WhatId::varchar)) between 41 and 70 then 100 when max(length(WhatId::varchar)) between 71 and 200 then 250 when max(length(WhatId::varchar)) between 201 and 400 then 500 when max(length(WhatId::varchar)) between 401 and 700 then 1000 when max(length(WhatId::varchar)) between 701 and 1700 then 2000 when max(length(WhatId::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(WhatId,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(WhatId,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(WhatId,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(WhatId,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(WhatId,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(WhatId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(WhatId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(WhatId,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(WhatId) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN WhatId is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 5 "position", 'Subject' column_name, count(1) cnt, max(length(Subject::varchar)) max_col_len, case when max(length(Subject::varchar)) < 20 then 20 when max(length(Subject::varchar)) between 21 and 40 then 50 when max(length(Subject::varchar)) between 41 and 70 then 100 when max(length(Subject::varchar)) between 71 and 200 then 250 when max(length(Subject::varchar)) between 201 and 400 then 500 when max(length(Subject::varchar)) between 401 and 700 then 1000 when max(length(Subject::varchar)) between 701 and 1700 then 2000 when max(length(Subject::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Subject,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Subject,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Subject,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Subject,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Subject,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Subject,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Subject,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Subject,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Subject) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Subject is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 6 "position", 'ActivityDate' column_name, count(1) cnt, max(length(ActivityDate::varchar)) max_col_len, case when max(length(ActivityDate::varchar)) < 20 then 20 when max(length(ActivityDate::varchar)) between 21 and 40 then 50 when max(length(ActivityDate::varchar)) between 41 and 70 then 100 when max(length(ActivityDate::varchar)) between 71 and 200 then 250 when max(length(ActivityDate::varchar)) between 201 and 400 then 500 when max(length(ActivityDate::varchar)) between 401 and 700 then 1000 when max(length(ActivityDate::varchar)) between 701 and 1700 then 2000 when max(length(ActivityDate::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(ActivityDate,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(ActivityDate,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(ActivityDate,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(ActivityDate,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(ActivityDate,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(ActivityDate,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(ActivityDate,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(ActivityDate,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(ActivityDate) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN ActivityDate is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 7 "position", 'Status' column_name, count(1) cnt, max(length(Status::varchar)) max_col_len, case when max(length(Status::varchar)) < 20 then 20 when max(length(Status::varchar)) between 21 and 40 then 50 when max(length(Status::varchar)) between 41 and 70 then 100 when max(length(Status::varchar)) between 71 and 200 then 250 when max(length(Status::varchar)) between 201 and 400 then 500 when max(length(Status::varchar)) between 401 and 700 then 1000 when max(length(Status::varchar)) between 701 and 1700 then 2000 when max(length(Status::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Status,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Status,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Status,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Status,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Status,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Status,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Status,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Status,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Status) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Status is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 8 "position", 'Priority' column_name, count(1) cnt, max(length(Priority::varchar)) max_col_len, case when max(length(Priority::varchar)) < 20 then 20 when max(length(Priority::varchar)) between 21 and 40 then 50 when max(length(Priority::varchar)) between 41 and 70 then 100 when max(length(Priority::varchar)) between 71 and 200 then 250 when max(length(Priority::varchar)) between 201 and 400 then 500 when max(length(Priority::varchar)) between 401 and 700 then 1000 when max(length(Priority::varchar)) between 701 and 1700 then 2000 when max(length(Priority::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Priority,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Priority,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Priority,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Priority,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Priority,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Priority,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Priority,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Priority,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Priority) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Priority is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 9 "position", 'OwnerId' column_name, count(1) cnt, max(length(OwnerId::varchar)) max_col_len, case when max(length(OwnerId::varchar)) < 20 then 20 when max(length(OwnerId::varchar)) between 21 and 40 then 50 when max(length(OwnerId::varchar)) between 41 and 70 then 100 when max(length(OwnerId::varchar)) between 71 and 200 then 250 when max(length(OwnerId::varchar)) between 201 and 400 then 500 when max(length(OwnerId::varchar)) between 401 and 700 then 1000 when max(length(OwnerId::varchar)) between 701 and 1700 then 2000 when max(length(OwnerId::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(OwnerId,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(OwnerId,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(OwnerId,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(OwnerId,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(OwnerId,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(OwnerId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(OwnerId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(OwnerId,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(OwnerId) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN OwnerId is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 10 "position", 'Description' column_name, count(1) cnt, max(length(Description::varchar)) max_col_len, case when max(length(Description::varchar)) < 20 then 20 when max(length(Description::varchar)) between 21 and 40 then 50 when max(length(Description::varchar)) between 41 and 70 then 100 when max(length(Description::varchar)) between 71 and 200 then 250 when max(length(Description::varchar)) between 201 and 400 then 500 when max(length(Description::varchar)) between 401 and 700 then 1000 when max(length(Description::varchar)) between 701 and 1700 then 2000 when max(length(Description::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Description,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Description,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Description,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Description,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Description,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Description,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Description,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Description,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Description) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Description is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 11 "position", 'Type' column_name, count(1) cnt, max(length(Type::varchar)) max_col_len, case when max(length(Type::varchar)) < 20 then 20 when max(length(Type::varchar)) between 21 and 40 then 50 when max(length(Type::varchar)) between 41 and 70 then 100 when max(length(Type::varchar)) between 71 and 200 then 250 when max(length(Type::varchar)) between 201 and 400 then 500 when max(length(Type::varchar)) between 401 and 700 then 1000 when max(length(Type::varchar)) between 701 and 1700 then 2000 when max(length(Type::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Type,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Type,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Type,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Type,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Type,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Type,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Type,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Type,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Type) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Type is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 12 "position", 'IsDeleted' column_name, count(1) cnt, max(length(IsDeleted::varchar)) max_col_len, case when max(length(IsDeleted::varchar)) < 20 then 20 when max(length(IsDeleted::varchar)) between 21 and 40 then 50 when max(length(IsDeleted::varchar)) between 41 and 70 then 100 when max(length(IsDeleted::varchar)) between 71 and 200 then 250 when max(length(IsDeleted::varchar)) between 201 and 400 then 500 when max(length(IsDeleted::varchar)) between 401 and 700 then 1000 when max(length(IsDeleted::varchar)) between 701 and 1700 then 2000 when max(length(IsDeleted::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(IsDeleted,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(IsDeleted,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(IsDeleted,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(IsDeleted,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(IsDeleted,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(IsDeleted,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(IsDeleted,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(IsDeleted,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(IsDeleted) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN IsDeleted is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 13 "position", 'AccountId' column_name, count(1) cnt, max(length(AccountId::varchar)) max_col_len, case when max(length(AccountId::varchar)) < 20 then 20 when max(length(AccountId::varchar)) between 21 and 40 then 50 when max(length(AccountId::varchar)) between 41 and 70 then 100 when max(length(AccountId::varchar)) between 71 and 200 then 250 when max(length(AccountId::varchar)) between 201 and 400 then 500 when max(length(AccountId::varchar)) between 401 and 700 then 1000 when max(length(AccountId::varchar)) between 701 and 1700 then 2000 when max(length(AccountId::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(AccountId,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(AccountId,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(AccountId,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(AccountId,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(AccountId,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(AccountId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(AccountId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(AccountId,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(AccountId) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN AccountId is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 14 "position", 'IsClosed' column_name, count(1) cnt, max(length(IsClosed::varchar)) max_col_len, case when max(length(IsClosed::varchar)) < 20 then 20 when max(length(IsClosed::varchar)) between 21 and 40 then 50 when max(length(IsClosed::varchar)) between 41 and 70 then 100 when max(length(IsClosed::varchar)) between 71 and 200 then 250 when max(length(IsClosed::varchar)) between 201 and 400 then 500 when max(length(IsClosed::varchar)) between 401 and 700 then 1000 when max(length(IsClosed::varchar)) between 701 and 1700 then 2000 when max(length(IsClosed::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(IsClosed,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(IsClosed,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(IsClosed,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(IsClosed,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(IsClosed,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(IsClosed,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(IsClosed,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(IsClosed,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(IsClosed) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN IsClosed is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 15 "position", 'CreatedDate' column_name, count(1) cnt, max(length(CreatedDate::varchar)) max_col_len, case when max(length(CreatedDate::varchar)) < 20 then 20 when max(length(CreatedDate::varchar)) between 21 and 40 then 50 when max(length(CreatedDate::varchar)) between 41 and 70 then 100 when max(length(CreatedDate::varchar)) between 71 and 200 then 250 when max(length(CreatedDate::varchar)) between 201 and 400 then 500 when max(length(CreatedDate::varchar)) between 401 and 700 then 1000 when max(length(CreatedDate::varchar)) between 701 and 1700 then 2000 when max(length(CreatedDate::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CreatedDate,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CreatedDate,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CreatedDate,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CreatedDate,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CreatedDate,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CreatedDate,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CreatedDate,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CreatedDate,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CreatedDate) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CreatedDate is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 16 "position", 'CreatedById' column_name, count(1) cnt, max(length(CreatedById::varchar)) max_col_len, case when max(length(CreatedById::varchar)) < 20 then 20 when max(length(CreatedById::varchar)) between 21 and 40 then 50 when max(length(CreatedById::varchar)) between 41 and 70 then 100 when max(length(CreatedById::varchar)) between 71 and 200 then 250 when max(length(CreatedById::varchar)) between 201 and 400 then 500 when max(length(CreatedById::varchar)) between 401 and 700 then 1000 when max(length(CreatedById::varchar)) between 701 and 1700 then 2000 when max(length(CreatedById::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CreatedById,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CreatedById,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CreatedById,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CreatedById,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CreatedById,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CreatedById,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CreatedById,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CreatedById,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CreatedById) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CreatedById is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 17 "position", 'LastModifiedDate' column_name, count(1) cnt, max(length(LastModifiedDate::varchar)) max_col_len, case when max(length(LastModifiedDate::varchar)) < 20 then 20 when max(length(LastModifiedDate::varchar)) between 21 and 40 then 50 when max(length(LastModifiedDate::varchar)) between 41 and 70 then 100 when max(length(LastModifiedDate::varchar)) between 71 and 200 then 250 when max(length(LastModifiedDate::varchar)) between 201 and 400 then 500 when max(length(LastModifiedDate::varchar)) between 401 and 700 then 1000 when max(length(LastModifiedDate::varchar)) between 701 and 1700 then 2000 when max(length(LastModifiedDate::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedDate,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedDate,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedDate,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedDate,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedDate,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedDate,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedDate,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedDate,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(LastModifiedDate) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN LastModifiedDate is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 18 "position", 'LastModifiedById' column_name, count(1) cnt, max(length(LastModifiedById::varchar)) max_col_len, case when max(length(LastModifiedById::varchar)) < 20 then 20 when max(length(LastModifiedById::varchar)) between 21 and 40 then 50 when max(length(LastModifiedById::varchar)) between 41 and 70 then 100 when max(length(LastModifiedById::varchar)) between 71 and 200 then 250 when max(length(LastModifiedById::varchar)) between 201 and 400 then 500 when max(length(LastModifiedById::varchar)) between 401 and 700 then 1000 when max(length(LastModifiedById::varchar)) between 701 and 1700 then 2000 when max(length(LastModifiedById::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedById,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedById,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedById,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedById,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedById,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedById,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedById,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(LastModifiedById,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(LastModifiedById) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN LastModifiedById is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 19 "position", 'SystemModstamp' column_name, count(1) cnt, max(length(SystemModstamp::varchar)) max_col_len, case when max(length(SystemModstamp::varchar)) < 20 then 20 when max(length(SystemModstamp::varchar)) between 21 and 40 then 50 when max(length(SystemModstamp::varchar)) between 41 and 70 then 100 when max(length(SystemModstamp::varchar)) between 71 and 200 then 250 when max(length(SystemModstamp::varchar)) between 201 and 400 then 500 when max(length(SystemModstamp::varchar)) between 401 and 700 then 1000 when max(length(SystemModstamp::varchar)) between 701 and 1700 then 2000 when max(length(SystemModstamp::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(SystemModstamp,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(SystemModstamp,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(SystemModstamp,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(SystemModstamp,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(SystemModstamp,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(SystemModstamp,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(SystemModstamp,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(SystemModstamp,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(SystemModstamp) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN SystemModstamp is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 20 "position", 'IsArchived' column_name, count(1) cnt, max(length(IsArchived::varchar)) max_col_len, case when max(length(IsArchived::varchar)) < 20 then 20 when max(length(IsArchived::varchar)) between 21 and 40 then 50 when max(length(IsArchived::varchar)) between 41 and 70 then 100 when max(length(IsArchived::varchar)) between 71 and 200 then 250 when max(length(IsArchived::varchar)) between 201 and 400 then 500 when max(length(IsArchived::varchar)) between 401 and 700 then 1000 when max(length(IsArchived::varchar)) between 701 and 1700 then 2000 when max(length(IsArchived::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(IsArchived,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(IsArchived,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(IsArchived,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(IsArchived,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(IsArchived,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(IsArchived,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(IsArchived,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(IsArchived,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(IsArchived) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN IsArchived is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 21 "position", 'IsVisibleInSelfService' column_name, count(1) cnt, max(length(IsVisibleInSelfService::varchar)) max_col_len, case when max(length(IsVisibleInSelfService::varchar)) < 20 then 20 when max(length(IsVisibleInSelfService::varchar)) between 21 and 40 then 50 when max(length(IsVisibleInSelfService::varchar)) between 41 and 70 then 100 when max(length(IsVisibleInSelfService::varchar)) between 71 and 200 then 250 when max(length(IsVisibleInSelfService::varchar)) between 201 and 400 then 500 when max(length(IsVisibleInSelfService::varchar)) between 401 and 700 then 1000 when max(length(IsVisibleInSelfService::varchar)) between 701 and 1700 then 2000 when max(length(IsVisibleInSelfService::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(IsVisibleInSelfService,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(IsVisibleInSelfService,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(IsVisibleInSelfService,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(IsVisibleInSelfService,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(IsVisibleInSelfService,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(IsVisibleInSelfService,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(IsVisibleInSelfService,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(IsVisibleInSelfService,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(IsVisibleInSelfService) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN IsVisibleInSelfService is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 22 "position", 'CallDurationInSeconds' column_name, count(1) cnt, max(length(CallDurationInSeconds::varchar)) max_col_len, case when max(length(CallDurationInSeconds::varchar)) < 20 then 20 when max(length(CallDurationInSeconds::varchar)) between 21 and 40 then 50 when max(length(CallDurationInSeconds::varchar)) between 41 and 70 then 100 when max(length(CallDurationInSeconds::varchar)) between 71 and 200 then 250 when max(length(CallDurationInSeconds::varchar)) between 201 and 400 then 500 when max(length(CallDurationInSeconds::varchar)) between 401 and 700 then 1000 when max(length(CallDurationInSeconds::varchar)) between 701 and 1700 then 2000 when max(length(CallDurationInSeconds::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CallDurationInSeconds,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CallDurationInSeconds,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CallDurationInSeconds,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CallDurationInSeconds,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CallDurationInSeconds,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CallDurationInSeconds,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CallDurationInSeconds,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CallDurationInSeconds,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CallDurationInSeconds) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CallDurationInSeconds is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 23 "position", 'CallType' column_name, count(1) cnt, max(length(CallType::varchar)) max_col_len, case when max(length(CallType::varchar)) < 20 then 20 when max(length(CallType::varchar)) between 21 and 40 then 50 when max(length(CallType::varchar)) between 41 and 70 then 100 when max(length(CallType::varchar)) between 71 and 200 then 250 when max(length(CallType::varchar)) between 201 and 400 then 500 when max(length(CallType::varchar)) between 401 and 700 then 1000 when max(length(CallType::varchar)) between 701 and 1700 then 2000 when max(length(CallType::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CallType,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CallType,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CallType,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CallType,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CallType,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CallType,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CallType,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CallType,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CallType) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CallType is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 24 "position", 'CallDisposition' column_name, count(1) cnt, max(length(CallDisposition::varchar)) max_col_len, case when max(length(CallDisposition::varchar)) < 20 then 20 when max(length(CallDisposition::varchar)) between 21 and 40 then 50 when max(length(CallDisposition::varchar)) between 41 and 70 then 100 when max(length(CallDisposition::varchar)) between 71 and 200 then 250 when max(length(CallDisposition::varchar)) between 201 and 400 then 500 when max(length(CallDisposition::varchar)) between 401 and 700 then 1000 when max(length(CallDisposition::varchar)) between 701 and 1700 then 2000 when max(length(CallDisposition::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CallDisposition,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CallDisposition,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CallDisposition,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CallDisposition,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CallDisposition,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CallDisposition,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CallDisposition,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CallDisposition,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CallDisposition) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CallDisposition is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 25 "position", 'CallObject' column_name, count(1) cnt, max(length(CallObject::varchar)) max_col_len, case when max(length(CallObject::varchar)) < 20 then 20 when max(length(CallObject::varchar)) between 21 and 40 then 50 when max(length(CallObject::varchar)) between 41 and 70 then 100 when max(length(CallObject::varchar)) between 71 and 200 then 250 when max(length(CallObject::varchar)) between 201 and 400 then 500 when max(length(CallObject::varchar)) between 401 and 700 then 1000 when max(length(CallObject::varchar)) between 701 and 1700 then 2000 when max(length(CallObject::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CallObject,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CallObject,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CallObject,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CallObject,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CallObject,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CallObject,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CallObject,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CallObject,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CallObject) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CallObject is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 26 "position", 'ReminderDateTime' column_name, count(1) cnt, max(length(ReminderDateTime::varchar)) max_col_len, case when max(length(ReminderDateTime::varchar)) < 20 then 20 when max(length(ReminderDateTime::varchar)) between 21 and 40 then 50 when max(length(ReminderDateTime::varchar)) between 41 and 70 then 100 when max(length(ReminderDateTime::varchar)) between 71 and 200 then 250 when max(length(ReminderDateTime::varchar)) between 201 and 400 then 500 when max(length(ReminderDateTime::varchar)) between 401 and 700 then 1000 when max(length(ReminderDateTime::varchar)) between 701 and 1700 then 2000 when max(length(ReminderDateTime::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(ReminderDateTime,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(ReminderDateTime,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(ReminderDateTime,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(ReminderDateTime,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(ReminderDateTime,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(ReminderDateTime,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(ReminderDateTime,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(ReminderDateTime,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(ReminderDateTime) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN ReminderDateTime is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 27 "position", 'IsReminderSet' column_name, count(1) cnt, max(length(IsReminderSet::varchar)) max_col_len, case when max(length(IsReminderSet::varchar)) < 20 then 20 when max(length(IsReminderSet::varchar)) between 21 and 40 then 50 when max(length(IsReminderSet::varchar)) between 41 and 70 then 100 when max(length(IsReminderSet::varchar)) between 71 and 200 then 250 when max(length(IsReminderSet::varchar)) between 201 and 400 then 500 when max(length(IsReminderSet::varchar)) between 401 and 700 then 1000 when max(length(IsReminderSet::varchar)) between 701 and 1700 then 2000 when max(length(IsReminderSet::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(IsReminderSet,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(IsReminderSet,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(IsReminderSet,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(IsReminderSet,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(IsReminderSet,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(IsReminderSet,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(IsReminderSet,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(IsReminderSet,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(IsReminderSet) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN IsReminderSet is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 28 "position", 'RecurrenceActivityId' column_name, count(1) cnt, max(length(RecurrenceActivityId::varchar)) max_col_len, case when max(length(RecurrenceActivityId::varchar)) < 20 then 20 when max(length(RecurrenceActivityId::varchar)) between 21 and 40 then 50 when max(length(RecurrenceActivityId::varchar)) between 41 and 70 then 100 when max(length(RecurrenceActivityId::varchar)) between 71 and 200 then 250 when max(length(RecurrenceActivityId::varchar)) between 201 and 400 then 500 when max(length(RecurrenceActivityId::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceActivityId::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceActivityId::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceActivityId,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceActivityId,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceActivityId,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceActivityId,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceActivityId,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceActivityId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceActivityId,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceActivityId,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceActivityId) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceActivityId is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 29 "position", 'IsRecurrence' column_name, count(1) cnt, max(length(IsRecurrence::varchar)) max_col_len, case when max(length(IsRecurrence::varchar)) < 20 then 20 when max(length(IsRecurrence::varchar)) between 21 and 40 then 50 when max(length(IsRecurrence::varchar)) between 41 and 70 then 100 when max(length(IsRecurrence::varchar)) between 71 and 200 then 250 when max(length(IsRecurrence::varchar)) between 201 and 400 then 500 when max(length(IsRecurrence::varchar)) between 401 and 700 then 1000 when max(length(IsRecurrence::varchar)) between 701 and 1700 then 2000 when max(length(IsRecurrence::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(IsRecurrence,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(IsRecurrence,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(IsRecurrence,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(IsRecurrence,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(IsRecurrence,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(IsRecurrence,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(IsRecurrence,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(IsRecurrence,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(IsRecurrence) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN IsRecurrence is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 30 "position", 'RecurrenceStartDateOnly' column_name, count(1) cnt, max(length(RecurrenceStartDateOnly::varchar)) max_col_len, case when max(length(RecurrenceStartDateOnly::varchar)) < 20 then 20 when max(length(RecurrenceStartDateOnly::varchar)) between 21 and 40 then 50 when max(length(RecurrenceStartDateOnly::varchar)) between 41 and 70 then 100 when max(length(RecurrenceStartDateOnly::varchar)) between 71 and 200 then 250 when max(length(RecurrenceStartDateOnly::varchar)) between 201 and 400 then 500 when max(length(RecurrenceStartDateOnly::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceStartDateOnly::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceStartDateOnly::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceStartDateOnly,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceStartDateOnly,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceStartDateOnly,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceStartDateOnly,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceStartDateOnly,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceStartDateOnly,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceStartDateOnly,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceStartDateOnly,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceStartDateOnly) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceStartDateOnly is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 31 "position", 'RecurrenceEndDateOnly' column_name, count(1) cnt, max(length(RecurrenceEndDateOnly::varchar)) max_col_len, case when max(length(RecurrenceEndDateOnly::varchar)) < 20 then 20 when max(length(RecurrenceEndDateOnly::varchar)) between 21 and 40 then 50 when max(length(RecurrenceEndDateOnly::varchar)) between 41 and 70 then 100 when max(length(RecurrenceEndDateOnly::varchar)) between 71 and 200 then 250 when max(length(RecurrenceEndDateOnly::varchar)) between 201 and 400 then 500 when max(length(RecurrenceEndDateOnly::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceEndDateOnly::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceEndDateOnly::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceEndDateOnly,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceEndDateOnly,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceEndDateOnly,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceEndDateOnly,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceEndDateOnly,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceEndDateOnly,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceEndDateOnly,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceEndDateOnly,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceEndDateOnly) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceEndDateOnly is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 32 "position", 'RecurrenceTimeZoneSidKey' column_name, count(1) cnt, max(length(RecurrenceTimeZoneSidKey::varchar)) max_col_len, case when max(length(RecurrenceTimeZoneSidKey::varchar)) < 20 then 20 when max(length(RecurrenceTimeZoneSidKey::varchar)) between 21 and 40 then 50 when max(length(RecurrenceTimeZoneSidKey::varchar)) between 41 and 70 then 100 when max(length(RecurrenceTimeZoneSidKey::varchar)) between 71 and 200 then 250 when max(length(RecurrenceTimeZoneSidKey::varchar)) between 201 and 400 then 500 when max(length(RecurrenceTimeZoneSidKey::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceTimeZoneSidKey::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceTimeZoneSidKey::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceTimeZoneSidKey,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceTimeZoneSidKey,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceTimeZoneSidKey,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceTimeZoneSidKey,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceTimeZoneSidKey,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceTimeZoneSidKey,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceTimeZoneSidKey,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceTimeZoneSidKey,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceTimeZoneSidKey) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceTimeZoneSidKey is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 33 "position", 'RecurrenceType' column_name, count(1) cnt, max(length(RecurrenceType::varchar)) max_col_len, case when max(length(RecurrenceType::varchar)) < 20 then 20 when max(length(RecurrenceType::varchar)) between 21 and 40 then 50 when max(length(RecurrenceType::varchar)) between 41 and 70 then 100 when max(length(RecurrenceType::varchar)) between 71 and 200 then 250 when max(length(RecurrenceType::varchar)) between 201 and 400 then 500 when max(length(RecurrenceType::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceType::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceType::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceType,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceType,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceType,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceType,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceType,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceType,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceType,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceType,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceType) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceType is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 34 "position", 'RecurrenceInterval' column_name, count(1) cnt, max(length(RecurrenceInterval::varchar)) max_col_len, case when max(length(RecurrenceInterval::varchar)) < 20 then 20 when max(length(RecurrenceInterval::varchar)) between 21 and 40 then 50 when max(length(RecurrenceInterval::varchar)) between 41 and 70 then 100 when max(length(RecurrenceInterval::varchar)) between 71 and 200 then 250 when max(length(RecurrenceInterval::varchar)) between 201 and 400 then 500 when max(length(RecurrenceInterval::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceInterval::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceInterval::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInterval,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInterval,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInterval,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInterval,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInterval,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInterval,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInterval,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInterval,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceInterval) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceInterval is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 35 "position", 'RecurrenceDayOfWeekMask' column_name, count(1) cnt, max(length(RecurrenceDayOfWeekMask::varchar)) max_col_len, case when max(length(RecurrenceDayOfWeekMask::varchar)) < 20 then 20 when max(length(RecurrenceDayOfWeekMask::varchar)) between 21 and 40 then 50 when max(length(RecurrenceDayOfWeekMask::varchar)) between 41 and 70 then 100 when max(length(RecurrenceDayOfWeekMask::varchar)) between 71 and 200 then 250 when max(length(RecurrenceDayOfWeekMask::varchar)) between 201 and 400 then 500 when max(length(RecurrenceDayOfWeekMask::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceDayOfWeekMask::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceDayOfWeekMask::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfWeekMask,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfWeekMask,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfWeekMask,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfWeekMask,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfWeekMask,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfWeekMask,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfWeekMask,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfWeekMask,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceDayOfWeekMask) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceDayOfWeekMask is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 36 "position", 'RecurrenceDayOfMonth' column_name, count(1) cnt, max(length(RecurrenceDayOfMonth::varchar)) max_col_len, case when max(length(RecurrenceDayOfMonth::varchar)) < 20 then 20 when max(length(RecurrenceDayOfMonth::varchar)) between 21 and 40 then 50 when max(length(RecurrenceDayOfMonth::varchar)) between 41 and 70 then 100 when max(length(RecurrenceDayOfMonth::varchar)) between 71 and 200 then 250 when max(length(RecurrenceDayOfMonth::varchar)) between 201 and 400 then 500 when max(length(RecurrenceDayOfMonth::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceDayOfMonth::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceDayOfMonth::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfMonth,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfMonth,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfMonth,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfMonth,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfMonth,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfMonth,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfMonth,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceDayOfMonth,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceDayOfMonth) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceDayOfMonth is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 37 "position", 'RecurrenceInstance' column_name, count(1) cnt, max(length(RecurrenceInstance::varchar)) max_col_len, case when max(length(RecurrenceInstance::varchar)) < 20 then 20 when max(length(RecurrenceInstance::varchar)) between 21 and 40 then 50 when max(length(RecurrenceInstance::varchar)) between 41 and 70 then 100 when max(length(RecurrenceInstance::varchar)) between 71 and 200 then 250 when max(length(RecurrenceInstance::varchar)) between 201 and 400 then 500 when max(length(RecurrenceInstance::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceInstance::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceInstance::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInstance,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInstance,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInstance,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInstance,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInstance,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInstance,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInstance,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceInstance,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceInstance) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceInstance is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 38 "position", 'RecurrenceMonthOfYear' column_name, count(1) cnt, max(length(RecurrenceMonthOfYear::varchar)) max_col_len, case when max(length(RecurrenceMonthOfYear::varchar)) < 20 then 20 when max(length(RecurrenceMonthOfYear::varchar)) between 21 and 40 then 50 when max(length(RecurrenceMonthOfYear::varchar)) between 41 and 70 then 100 when max(length(RecurrenceMonthOfYear::varchar)) between 71 and 200 then 250 when max(length(RecurrenceMonthOfYear::varchar)) between 201 and 400 then 500 when max(length(RecurrenceMonthOfYear::varchar)) between 401 and 700 then 1000 when max(length(RecurrenceMonthOfYear::varchar)) between 701 and 1700 then 2000 when max(length(RecurrenceMonthOfYear::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceMonthOfYear,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceMonthOfYear,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceMonthOfYear,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceMonthOfYear,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceMonthOfYear,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceMonthOfYear,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceMonthOfYear,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(RecurrenceMonthOfYear,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(RecurrenceMonthOfYear) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN RecurrenceMonthOfYear is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 39 "position", 'Medium__c' column_name, count(1) cnt, max(length(Medium__c::varchar)) max_col_len, case when max(length(Medium__c::varchar)) < 20 then 20 when max(length(Medium__c::varchar)) between 21 and 40 then 50 when max(length(Medium__c::varchar)) between 41 and 70 then 100 when max(length(Medium__c::varchar)) between 71 and 200 then 250 when max(length(Medium__c::varchar)) between 201 and 400 then 500 when max(length(Medium__c::varchar)) between 401 and 700 then 1000 when max(length(Medium__c::varchar)) between 701 and 1700 then 2000 when max(length(Medium__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Medium__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Medium__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Medium__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Medium__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Medium__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Medium__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Medium__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Medium__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Medium__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Medium__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 40 "position", 'Is_Future_Event__c' column_name, count(1) cnt, max(length(Is_Future_Event__c::varchar)) max_col_len, case when max(length(Is_Future_Event__c::varchar)) < 20 then 20 when max(length(Is_Future_Event__c::varchar)) between 21 and 40 then 50 when max(length(Is_Future_Event__c::varchar)) between 41 and 70 then 100 when max(length(Is_Future_Event__c::varchar)) between 71 and 200 then 250 when max(length(Is_Future_Event__c::varchar)) between 201 and 400 then 500 when max(length(Is_Future_Event__c::varchar)) between 401 and 700 then 1000 when max(length(Is_Future_Event__c::varchar)) between 701 and 1700 then 2000 when max(length(Is_Future_Event__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Is_Future_Event__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Is_Future_Event__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Is_Future_Event__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Is_Future_Event__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Is_Future_Event__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Is_Future_Event__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Is_Future_Event__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Is_Future_Event__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Is_Future_Event__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Is_Future_Event__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 41 "position", 'Call_Object_Identifier__c' column_name, count(1) cnt, max(length(Call_Object_Identifier__c::varchar)) max_col_len, case when max(length(Call_Object_Identifier__c::varchar)) < 20 then 20 when max(length(Call_Object_Identifier__c::varchar)) between 21 and 40 then 50 when max(length(Call_Object_Identifier__c::varchar)) between 41 and 70 then 100 when max(length(Call_Object_Identifier__c::varchar)) between 71 and 200 then 250 when max(length(Call_Object_Identifier__c::varchar)) between 201 and 400 then 500 when max(length(Call_Object_Identifier__c::varchar)) between 401 and 700 then 1000 when max(length(Call_Object_Identifier__c::varchar)) between 701 and 1700 then 2000 when max(length(Call_Object_Identifier__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Call_Object_Identifier__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Call_Object_Identifier__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Call_Object_Identifier__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Call_Object_Identifier__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Call_Object_Identifier__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Call_Object_Identifier__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Call_Object_Identifier__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Call_Object_Identifier__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Call_Object_Identifier__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Call_Object_Identifier__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 42 "position", 'Activity_Type__c' column_name, count(1) cnt, max(length(Activity_Type__c::varchar)) max_col_len, case when max(length(Activity_Type__c::varchar)) < 20 then 20 when max(length(Activity_Type__c::varchar)) between 21 and 40 then 50 when max(length(Activity_Type__c::varchar)) between 41 and 70 then 100 when max(length(Activity_Type__c::varchar)) between 71 and 200 then 250 when max(length(Activity_Type__c::varchar)) between 201 and 400 then 500 when max(length(Activity_Type__c::varchar)) between 401 and 700 then 1000 when max(length(Activity_Type__c::varchar)) between 701 and 1700 then 2000 when max(length(Activity_Type__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Activity_Type__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Activity_Type__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Activity_Type__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Activity_Type__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Activity_Type__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Activity_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Activity_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Activity_Type__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Activity_Type__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Activity_Type__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 43 "position", 'Related_Event_Id__c' column_name, count(1) cnt, max(length(Related_Event_Id__c::varchar)) max_col_len, case when max(length(Related_Event_Id__c::varchar)) < 20 then 20 when max(length(Related_Event_Id__c::varchar)) between 21 and 40 then 50 when max(length(Related_Event_Id__c::varchar)) between 41 and 70 then 100 when max(length(Related_Event_Id__c::varchar)) between 71 and 200 then 250 when max(length(Related_Event_Id__c::varchar)) between 201 and 400 then 500 when max(length(Related_Event_Id__c::varchar)) between 401 and 700 then 1000 when max(length(Related_Event_Id__c::varchar)) between 701 and 1700 then 2000 when max(length(Related_Event_Id__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Related_Event_Id__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Related_Event_Id__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Related_Event_Id__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Related_Event_Id__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Related_Event_Id__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Related_Event_Id__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Related_Event_Id__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Related_Event_Id__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Related_Event_Id__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Related_Event_Id__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 44 "position", 'Communicate_PM_action__c' column_name, count(1) cnt, max(length(Communicate_PM_action__c::varchar)) max_col_len, case when max(length(Communicate_PM_action__c::varchar)) < 20 then 20 when max(length(Communicate_PM_action__c::varchar)) between 21 and 40 then 50 when max(length(Communicate_PM_action__c::varchar)) between 41 and 70 then 100 when max(length(Communicate_PM_action__c::varchar)) between 71 and 200 then 250 when max(length(Communicate_PM_action__c::varchar)) between 201 and 400 then 500 when max(length(Communicate_PM_action__c::varchar)) between 401 and 700 then 1000 when max(length(Communicate_PM_action__c::varchar)) between 701 and 1700 then 2000 when max(length(Communicate_PM_action__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Communicate_PM_action__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Communicate_PM_action__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Communicate_PM_action__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Communicate_PM_action__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Communicate_PM_action__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Communicate_PM_action__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Communicate_PM_action__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Communicate_PM_action__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Communicate_PM_action__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Communicate_PM_action__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 45 "position", 'Customer_is_satisfied__c' column_name, count(1) cnt, max(length(Customer_is_satisfied__c::varchar)) max_col_len, case when max(length(Customer_is_satisfied__c::varchar)) < 20 then 20 when max(length(Customer_is_satisfied__c::varchar)) between 21 and 40 then 50 when max(length(Customer_is_satisfied__c::varchar)) between 41 and 70 then 100 when max(length(Customer_is_satisfied__c::varchar)) between 71 and 200 then 250 when max(length(Customer_is_satisfied__c::varchar)) between 201 and 400 then 500 when max(length(Customer_is_satisfied__c::varchar)) between 401 and 700 then 1000 when max(length(Customer_is_satisfied__c::varchar)) between 701 and 1700 then 2000 when max(length(Customer_is_satisfied__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Customer_is_satisfied__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Customer_is_satisfied__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Customer_is_satisfied__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Customer_is_satisfied__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Customer_is_satisfied__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Customer_is_satisfied__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Customer_is_satisfied__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Customer_is_satisfied__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Customer_is_satisfied__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Customer_is_satisfied__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 46 "position", 'Facilitate_performance_review__c' column_name, count(1) cnt, max(length(Facilitate_performance_review__c::varchar)) max_col_len, case when max(length(Facilitate_performance_review__c::varchar)) < 20 then 20 when max(length(Facilitate_performance_review__c::varchar)) between 21 and 40 then 50 when max(length(Facilitate_performance_review__c::varchar)) between 41 and 70 then 100 when max(length(Facilitate_performance_review__c::varchar)) between 71 and 200 then 250 when max(length(Facilitate_performance_review__c::varchar)) between 201 and 400 then 500 when max(length(Facilitate_performance_review__c::varchar)) between 401 and 700 then 1000 when max(length(Facilitate_performance_review__c::varchar)) between 701 and 1700 then 2000 when max(length(Facilitate_performance_review__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Facilitate_performance_review__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Facilitate_performance_review__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Facilitate_performance_review__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Facilitate_performance_review__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Facilitate_performance_review__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Facilitate_performance_review__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Facilitate_performance_review__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Facilitate_performance_review__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Facilitate_performance_review__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Facilitate_performance_review__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 47 "position", 'Customer_Sentiment__c' column_name, count(1) cnt, max(length(Customer_Sentiment__c::varchar)) max_col_len, case when max(length(Customer_Sentiment__c::varchar)) < 20 then 20 when max(length(Customer_Sentiment__c::varchar)) between 21 and 40 then 50 when max(length(Customer_Sentiment__c::varchar)) between 41 and 70 then 100 when max(length(Customer_Sentiment__c::varchar)) between 71 and 200 then 250 when max(length(Customer_Sentiment__c::varchar)) between 201 and 400 then 500 when max(length(Customer_Sentiment__c::varchar)) between 401 and 700 then 1000 when max(length(Customer_Sentiment__c::varchar)) between 701 and 1700 then 2000 when max(length(Customer_Sentiment__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Customer_Sentiment__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Customer_Sentiment__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Customer_Sentiment__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Customer_Sentiment__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Customer_Sentiment__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Customer_Sentiment__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Customer_Sentiment__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Customer_Sentiment__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Customer_Sentiment__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Customer_Sentiment__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 48 "position", 'Interaction_Type__c' column_name, count(1) cnt, max(length(Interaction_Type__c::varchar)) max_col_len, case when max(length(Interaction_Type__c::varchar)) < 20 then 20 when max(length(Interaction_Type__c::varchar)) between 21 and 40 then 50 when max(length(Interaction_Type__c::varchar)) between 41 and 70 then 100 when max(length(Interaction_Type__c::varchar)) between 71 and 200 then 250 when max(length(Interaction_Type__c::varchar)) between 201 and 400 then 500 when max(length(Interaction_Type__c::varchar)) between 401 and 700 then 1000 when max(length(Interaction_Type__c::varchar)) between 701 and 1700 then 2000 when max(length(Interaction_Type__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Type__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Type__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Type__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Type__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Type__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Type__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Interaction_Type__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Interaction_Type__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 49 "position", 'Assign_to_YPID__c' column_name, count(1) cnt, max(length(Assign_to_YPID__c::varchar)) max_col_len, case when max(length(Assign_to_YPID__c::varchar)) < 20 then 20 when max(length(Assign_to_YPID__c::varchar)) between 21 and 40 then 50 when max(length(Assign_to_YPID__c::varchar)) between 41 and 70 then 100 when max(length(Assign_to_YPID__c::varchar)) between 71 and 200 then 250 when max(length(Assign_to_YPID__c::varchar)) between 201 and 400 then 500 when max(length(Assign_to_YPID__c::varchar)) between 401 and 700 then 1000 when max(length(Assign_to_YPID__c::varchar)) between 701 and 1700 then 2000 when max(length(Assign_to_YPID__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Assign_to_YPID__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Assign_to_YPID__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Assign_to_YPID__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Assign_to_YPID__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Assign_to_YPID__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Assign_to_YPID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Assign_to_YPID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Assign_to_YPID__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Assign_to_YPID__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Assign_to_YPID__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 50 "position", 'Meeting_Type__c' column_name, count(1) cnt, max(length(Meeting_Type__c::varchar)) max_col_len, case when max(length(Meeting_Type__c::varchar)) < 20 then 20 when max(length(Meeting_Type__c::varchar)) between 21 and 40 then 50 when max(length(Meeting_Type__c::varchar)) between 41 and 70 then 100 when max(length(Meeting_Type__c::varchar)) between 71 and 200 then 250 when max(length(Meeting_Type__c::varchar)) between 201 and 400 then 500 when max(length(Meeting_Type__c::varchar)) between 401 and 700 then 1000 when max(length(Meeting_Type__c::varchar)) between 701 and 1700 then 2000 when max(length(Meeting_Type__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Type__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Type__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Type__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Type__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Type__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Type__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Meeting_Type__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Meeting_Type__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 51 "position", 'Created_By_Role__c' column_name, count(1) cnt, max(length(Created_By_Role__c::varchar)) max_col_len, case when max(length(Created_By_Role__c::varchar)) < 20 then 20 when max(length(Created_By_Role__c::varchar)) between 21 and 40 then 50 when max(length(Created_By_Role__c::varchar)) between 41 and 70 then 100 when max(length(Created_By_Role__c::varchar)) between 71 and 200 then 250 when max(length(Created_By_Role__c::varchar)) between 201 and 400 then 500 when max(length(Created_By_Role__c::varchar)) between 401 and 700 then 1000 when max(length(Created_By_Role__c::varchar)) between 701 and 1700 then 2000 when max(length(Created_By_Role__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Created_By_Role__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Created_By_Role__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Created_By_Role__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Created_By_Role__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Created_By_Role__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Created_By_Role__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Created_By_Role__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Created_By_Role__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Created_By_Role__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Created_By_Role__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 52 "position", 'Percent_Complete__c' column_name, count(1) cnt, max(length(Percent_Complete__c::varchar)) max_col_len, case when max(length(Percent_Complete__c::varchar)) < 20 then 20 when max(length(Percent_Complete__c::varchar)) between 21 and 40 then 50 when max(length(Percent_Complete__c::varchar)) between 41 and 70 then 100 when max(length(Percent_Complete__c::varchar)) between 71 and 200 then 250 when max(length(Percent_Complete__c::varchar)) between 201 and 400 then 500 when max(length(Percent_Complete__c::varchar)) between 401 and 700 then 1000 when max(length(Percent_Complete__c::varchar)) between 701 and 1700 then 2000 when max(length(Percent_Complete__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Percent_Complete__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Percent_Complete__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Percent_Complete__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Percent_Complete__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Percent_Complete__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Percent_Complete__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Percent_Complete__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Percent_Complete__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Percent_Complete__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Percent_Complete__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 53 "position", 'Appointments__c' column_name, count(1) cnt, max(length(Appointments__c::varchar)) max_col_len, case when max(length(Appointments__c::varchar)) < 20 then 20 when max(length(Appointments__c::varchar)) between 21 and 40 then 50 when max(length(Appointments__c::varchar)) between 41 and 70 then 100 when max(length(Appointments__c::varchar)) between 71 and 200 then 250 when max(length(Appointments__c::varchar)) between 201 and 400 then 500 when max(length(Appointments__c::varchar)) between 401 and 700 then 1000 when max(length(Appointments__c::varchar)) between 701 and 1700 then 2000 when max(length(Appointments__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Appointments__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Appointments__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Appointments__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Appointments__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Appointments__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Appointments__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Appointments__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Appointments__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Appointments__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Appointments__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 54 "position", 'Presentations__c' column_name, count(1) cnt, max(length(Presentations__c::varchar)) max_col_len, case when max(length(Presentations__c::varchar)) < 20 then 20 when max(length(Presentations__c::varchar)) between 21 and 40 then 50 when max(length(Presentations__c::varchar)) between 41 and 70 then 100 when max(length(Presentations__c::varchar)) between 71 and 200 then 250 when max(length(Presentations__c::varchar)) between 201 and 400 then 500 when max(length(Presentations__c::varchar)) between 401 and 700 then 1000 when max(length(Presentations__c::varchar)) between 701 and 1700 then 2000 when max(length(Presentations__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Presentations__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Presentations__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Presentations__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Presentations__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Presentations__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Presentations__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Presentations__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Presentations__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Presentations__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Presentations__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 55 "position", 'Call_Type__c' column_name, count(1) cnt, max(length(Call_Type__c::varchar)) max_col_len, case when max(length(Call_Type__c::varchar)) < 20 then 20 when max(length(Call_Type__c::varchar)) between 21 and 40 then 50 when max(length(Call_Type__c::varchar)) between 41 and 70 then 100 when max(length(Call_Type__c::varchar)) between 71 and 200 then 250 when max(length(Call_Type__c::varchar)) between 201 and 400 then 500 when max(length(Call_Type__c::varchar)) between 401 and 700 then 1000 when max(length(Call_Type__c::varchar)) between 701 and 1700 then 2000 when max(length(Call_Type__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Call_Type__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Call_Type__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Call_Type__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Call_Type__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Call_Type__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Call_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Call_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Call_Type__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Call_Type__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Call_Type__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 56 "position", 'Notes__c' column_name, count(1) cnt, max(length(Notes__c::varchar)) max_col_len, case when max(length(Notes__c::varchar)) < 20 then 20 when max(length(Notes__c::varchar)) between 21 and 40 then 50 when max(length(Notes__c::varchar)) between 41 and 70 then 100 when max(length(Notes__c::varchar)) between 71 and 200 then 250 when max(length(Notes__c::varchar)) between 201 and 400 then 500 when max(length(Notes__c::varchar)) between 401 and 700 then 1000 when max(length(Notes__c::varchar)) between 701 and 1700 then 2000 when max(length(Notes__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Notes__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Notes__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Notes__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Notes__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Notes__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Notes__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Notes__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Notes__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 57 "position", 'Appointment_Type__c' column_name, count(1) cnt, max(length(Appointment_Type__c::varchar)) max_col_len, case when max(length(Appointment_Type__c::varchar)) < 20 then 20 when max(length(Appointment_Type__c::varchar)) between 21 and 40 then 50 when max(length(Appointment_Type__c::varchar)) between 41 and 70 then 100 when max(length(Appointment_Type__c::varchar)) between 71 and 200 then 250 when max(length(Appointment_Type__c::varchar)) between 201 and 400 then 500 when max(length(Appointment_Type__c::varchar)) between 401 and 700 then 1000 when max(length(Appointment_Type__c::varchar)) between 701 and 1700 then 2000 when max(length(Appointment_Type__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Appointment_Type__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Appointment_Type__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Appointment_Type__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Appointment_Type__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Appointment_Type__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Appointment_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Appointment_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Appointment_Type__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Appointment_Type__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Appointment_Type__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 58 "position", 'Business_Group__c' column_name, count(1) cnt, max(length(Business_Group__c::varchar)) max_col_len, case when max(length(Business_Group__c::varchar)) < 20 then 20 when max(length(Business_Group__c::varchar)) between 21 and 40 then 50 when max(length(Business_Group__c::varchar)) between 41 and 70 then 100 when max(length(Business_Group__c::varchar)) between 71 and 200 then 250 when max(length(Business_Group__c::varchar)) between 201 and 400 then 500 when max(length(Business_Group__c::varchar)) between 401 and 700 then 1000 when max(length(Business_Group__c::varchar)) between 701 and 1700 then 2000 when max(length(Business_Group__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Business_Group__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Business_Group__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Business_Group__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Business_Group__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Business_Group__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Business_Group__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Business_Group__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Business_Group__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Business_Group__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Business_Group__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 59 "position", 'Meeting_Notes__c' column_name, count(1) cnt, max(length(Meeting_Notes__c::varchar)) max_col_len, case when max(length(Meeting_Notes__c::varchar)) < 20 then 20 when max(length(Meeting_Notes__c::varchar)) between 21 and 40 then 50 when max(length(Meeting_Notes__c::varchar)) between 41 and 70 then 100 when max(length(Meeting_Notes__c::varchar)) between 71 and 200 then 250 when max(length(Meeting_Notes__c::varchar)) between 201 and 400 then 500 when max(length(Meeting_Notes__c::varchar)) between 401 and 700 then 1000 when max(length(Meeting_Notes__c::varchar)) between 701 and 1700 then 2000 when max(length(Meeting_Notes__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Notes__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Notes__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Notes__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Notes__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Notes__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Meeting_Notes__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Meeting_Notes__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Meeting_Notes__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 60 "position", 'Number_Of_Reschedules__c' column_name, count(1) cnt, max(length(Number_Of_Reschedules__c::varchar)) max_col_len, case when max(length(Number_Of_Reschedules__c::varchar)) < 20 then 20 when max(length(Number_Of_Reschedules__c::varchar)) between 21 and 40 then 50 when max(length(Number_Of_Reschedules__c::varchar)) between 41 and 70 then 100 when max(length(Number_Of_Reschedules__c::varchar)) between 71 and 200 then 250 when max(length(Number_Of_Reschedules__c::varchar)) between 201 and 400 then 500 when max(length(Number_Of_Reschedules__c::varchar)) between 401 and 700 then 1000 when max(length(Number_Of_Reschedules__c::varchar)) between 701 and 1700 then 2000 when max(length(Number_Of_Reschedules__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Number_Of_Reschedules__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Number_Of_Reschedules__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Number_Of_Reschedules__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Number_Of_Reschedules__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Number_Of_Reschedules__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Number_Of_Reschedules__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Number_Of_Reschedules__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Number_Of_Reschedules__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Number_Of_Reschedules__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Number_Of_Reschedules__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 61 "position", 'Reschedule_Event__c' column_name, count(1) cnt, max(length(Reschedule_Event__c::varchar)) max_col_len, case when max(length(Reschedule_Event__c::varchar)) < 20 then 20 when max(length(Reschedule_Event__c::varchar)) between 21 and 40 then 50 when max(length(Reschedule_Event__c::varchar)) between 41 and 70 then 100 when max(length(Reschedule_Event__c::varchar)) between 71 and 200 then 250 when max(length(Reschedule_Event__c::varchar)) between 201 and 400 then 500 when max(length(Reschedule_Event__c::varchar)) between 401 and 700 then 1000 when max(length(Reschedule_Event__c::varchar)) between 701 and 1700 then 2000 when max(length(Reschedule_Event__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Reschedule_Event__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Reschedule_Event__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Reschedule_Event__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Reschedule_Event__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Reschedule_Event__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Reschedule_Event__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Reschedule_Event__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Reschedule_Event__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Reschedule_Event__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Reschedule_Event__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 62 "position", 'OOR_Private__c' column_name, count(1) cnt, max(length(OOR_Private__c::varchar)) max_col_len, case when max(length(OOR_Private__c::varchar)) < 20 then 20 when max(length(OOR_Private__c::varchar)) between 21 and 40 then 50 when max(length(OOR_Private__c::varchar)) between 41 and 70 then 100 when max(length(OOR_Private__c::varchar)) between 71 and 200 then 250 when max(length(OOR_Private__c::varchar)) between 201 and 400 then 500 when max(length(OOR_Private__c::varchar)) between 401 and 700 then 1000 when max(length(OOR_Private__c::varchar)) between 701 and 1700 then 2000 when max(length(OOR_Private__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(OOR_Private__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(OOR_Private__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(OOR_Private__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(OOR_Private__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(OOR_Private__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(OOR_Private__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(OOR_Private__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(OOR_Private__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(OOR_Private__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN OOR_Private__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 63 "position", 'Account_Link__c' column_name, count(1) cnt, max(length(Account_Link__c::varchar)) max_col_len, case when max(length(Account_Link__c::varchar)) < 20 then 20 when max(length(Account_Link__c::varchar)) between 21 and 40 then 50 when max(length(Account_Link__c::varchar)) between 41 and 70 then 100 when max(length(Account_Link__c::varchar)) between 71 and 200 then 250 when max(length(Account_Link__c::varchar)) between 201 and 400 then 500 when max(length(Account_Link__c::varchar)) between 401 and 700 then 1000 when max(length(Account_Link__c::varchar)) between 701 and 1700 then 2000 when max(length(Account_Link__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Account_Link__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Account_Link__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Account_Link__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Account_Link__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Account_Link__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Account_Link__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Account_Link__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Account_Link__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Account_Link__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Account_Link__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 64 "position", 'OpportunityId__c' column_name, count(1) cnt, max(length(OpportunityId__c::varchar)) max_col_len, case when max(length(OpportunityId__c::varchar)) < 20 then 20 when max(length(OpportunityId__c::varchar)) between 21 and 40 then 50 when max(length(OpportunityId__c::varchar)) between 41 and 70 then 100 when max(length(OpportunityId__c::varchar)) between 71 and 200 then 250 when max(length(OpportunityId__c::varchar)) between 201 and 400 then 500 when max(length(OpportunityId__c::varchar)) between 401 and 700 then 1000 when max(length(OpportunityId__c::varchar)) between 701 and 1700 then 2000 when max(length(OpportunityId__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(OpportunityId__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(OpportunityId__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(OpportunityId__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(OpportunityId__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(OpportunityId__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(OpportunityId__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(OpportunityId__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(OpportunityId__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(OpportunityId__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN OpportunityId__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 65 "position", 'Order_Details__c' column_name, count(1) cnt, max(length(Order_Details__c::varchar)) max_col_len, case when max(length(Order_Details__c::varchar)) < 20 then 20 when max(length(Order_Details__c::varchar)) between 21 and 40 then 50 when max(length(Order_Details__c::varchar)) between 41 and 70 then 100 when max(length(Order_Details__c::varchar)) between 71 and 200 then 250 when max(length(Order_Details__c::varchar)) between 201 and 400 then 500 when max(length(Order_Details__c::varchar)) between 401 and 700 then 1000 when max(length(Order_Details__c::varchar)) between 701 and 1700 then 2000 when max(length(Order_Details__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Order_Details__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Order_Details__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Order_Details__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Order_Details__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Order_Details__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Order_Details__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Order_Details__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Order_Details__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Order_Details__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Order_Details__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 66 "position", 'Server_URL__c' column_name, count(1) cnt, max(length(Server_URL__c::varchar)) max_col_len, case when max(length(Server_URL__c::varchar)) < 20 then 20 when max(length(Server_URL__c::varchar)) between 21 and 40 then 50 when max(length(Server_URL__c::varchar)) between 41 and 70 then 100 when max(length(Server_URL__c::varchar)) between 71 and 200 then 250 when max(length(Server_URL__c::varchar)) between 201 and 400 then 500 when max(length(Server_URL__c::varchar)) between 401 and 700 then 1000 when max(length(Server_URL__c::varchar)) between 701 and 1700 then 2000 when max(length(Server_URL__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Server_URL__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Server_URL__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Server_URL__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Server_URL__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Server_URL__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Server_URL__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Server_URL__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Server_URL__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Server_URL__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Server_URL__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 67 "position", 'UCID__c' column_name, count(1) cnt, max(length(UCID__c::varchar)) max_col_len, case when max(length(UCID__c::varchar)) < 20 then 20 when max(length(UCID__c::varchar)) between 21 and 40 then 50 when max(length(UCID__c::varchar)) between 41 and 70 then 100 when max(length(UCID__c::varchar)) between 71 and 200 then 250 when max(length(UCID__c::varchar)) between 201 and 400 then 500 when max(length(UCID__c::varchar)) between 401 and 700 then 1000 when max(length(UCID__c::varchar)) between 701 and 1700 then 2000 when max(length(UCID__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(UCID__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(UCID__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(UCID__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(UCID__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(UCID__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(UCID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(UCID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(UCID__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(UCID__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN UCID__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 68 "position", 'Created_By_YPID__c' column_name, count(1) cnt, max(length(Created_By_YPID__c::varchar)) max_col_len, case when max(length(Created_By_YPID__c::varchar)) < 20 then 20 when max(length(Created_By_YPID__c::varchar)) between 21 and 40 then 50 when max(length(Created_By_YPID__c::varchar)) between 41 and 70 then 100 when max(length(Created_By_YPID__c::varchar)) between 71 and 200 then 250 when max(length(Created_By_YPID__c::varchar)) between 201 and 400 then 500 when max(length(Created_By_YPID__c::varchar)) between 401 and 700 then 1000 when max(length(Created_By_YPID__c::varchar)) between 701 and 1700 then 2000 when max(length(Created_By_YPID__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Created_By_YPID__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Created_By_YPID__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Created_By_YPID__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Created_By_YPID__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Created_By_YPID__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Created_By_YPID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Created_By_YPID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Created_By_YPID__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Created_By_YPID__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Created_By_YPID__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 69 "position", 'Activity_Counter__c' column_name, count(1) cnt, max(length(Activity_Counter__c::varchar)) max_col_len, case when max(length(Activity_Counter__c::varchar)) < 20 then 20 when max(length(Activity_Counter__c::varchar)) between 21 and 40 then 50 when max(length(Activity_Counter__c::varchar)) between 41 and 70 then 100 when max(length(Activity_Counter__c::varchar)) between 71 and 200 then 250 when max(length(Activity_Counter__c::varchar)) between 201 and 400 then 500 when max(length(Activity_Counter__c::varchar)) between 401 and 700 then 1000 when max(length(Activity_Counter__c::varchar)) between 701 and 1700 then 2000 when max(length(Activity_Counter__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Activity_Counter__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Activity_Counter__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Activity_Counter__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Activity_Counter__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Activity_Counter__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Activity_Counter__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Activity_Counter__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Activity_Counter__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Activity_Counter__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Activity_Counter__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 70 "position", 'Task_Completed_Date__c' column_name, count(1) cnt, max(length(Task_Completed_Date__c::varchar)) max_col_len, case when max(length(Task_Completed_Date__c::varchar)) < 20 then 20 when max(length(Task_Completed_Date__c::varchar)) between 21 and 40 then 50 when max(length(Task_Completed_Date__c::varchar)) between 41 and 70 then 100 when max(length(Task_Completed_Date__c::varchar)) between 71 and 200 then 250 when max(length(Task_Completed_Date__c::varchar)) between 201 and 400 then 500 when max(length(Task_Completed_Date__c::varchar)) between 401 and 700 then 1000 when max(length(Task_Completed_Date__c::varchar)) between 701 and 1700 then 2000 when max(length(Task_Completed_Date__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Task_Completed_Date__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Task_Completed_Date__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Task_Completed_Date__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Task_Completed_Date__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Task_Completed_Date__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Task_Completed_Date__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Task_Completed_Date__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Task_Completed_Date__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Task_Completed_Date__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Task_Completed_Date__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 71 "position", 'Task_SLA_Days__c' column_name, count(1) cnt, max(length(Task_SLA_Days__c::varchar)) max_col_len, case when max(length(Task_SLA_Days__c::varchar)) < 20 then 20 when max(length(Task_SLA_Days__c::varchar)) between 21 and 40 then 50 when max(length(Task_SLA_Days__c::varchar)) between 41 and 70 then 100 when max(length(Task_SLA_Days__c::varchar)) between 71 and 200 then 250 when max(length(Task_SLA_Days__c::varchar)) between 201 and 400 then 500 when max(length(Task_SLA_Days__c::varchar)) between 401 and 700 then 1000 when max(length(Task_SLA_Days__c::varchar)) between 701 and 1700 then 2000 when max(length(Task_SLA_Days__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA_Days__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA_Days__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA_Days__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA_Days__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA_Days__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA_Days__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA_Days__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA_Days__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Task_SLA_Days__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Task_SLA_Days__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 72 "position", 'Task_SLA__c' column_name, count(1) cnt, max(length(Task_SLA__c::varchar)) max_col_len, case when max(length(Task_SLA__c::varchar)) < 20 then 20 when max(length(Task_SLA__c::varchar)) between 21 and 40 then 50 when max(length(Task_SLA__c::varchar)) between 41 and 70 then 100 when max(length(Task_SLA__c::varchar)) between 71 and 200 then 250 when max(length(Task_SLA__c::varchar)) between 201 and 400 then 500 when max(length(Task_SLA__c::varchar)) between 401 and 700 then 1000 when max(length(Task_SLA__c::varchar)) between 701 and 1700 then 2000 when max(length(Task_SLA__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Task_SLA__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Task_SLA__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Task_SLA__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 73 "position", 'Campaign_CTN__c' column_name, count(1) cnt, max(length(Campaign_CTN__c::varchar)) max_col_len, case when max(length(Campaign_CTN__c::varchar)) < 20 then 20 when max(length(Campaign_CTN__c::varchar)) between 21 and 40 then 50 when max(length(Campaign_CTN__c::varchar)) between 41 and 70 then 100 when max(length(Campaign_CTN__c::varchar)) between 71 and 200 then 250 when max(length(Campaign_CTN__c::varchar)) between 201 and 400 then 500 when max(length(Campaign_CTN__c::varchar)) between 401 and 700 then 1000 when max(length(Campaign_CTN__c::varchar)) between 701 and 1700 then 2000 when max(length(Campaign_CTN__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Campaign_CTN__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Campaign_CTN__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Campaign_CTN__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Campaign_CTN__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Campaign_CTN__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Campaign_CTN__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Campaign_CTN__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Campaign_CTN__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Campaign_CTN__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Campaign_CTN__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 74 "position", 'Assigned_To_is_Running_User__c' column_name, count(1) cnt, max(length(Assigned_To_is_Running_User__c::varchar)) max_col_len, case when max(length(Assigned_To_is_Running_User__c::varchar)) < 20 then 20 when max(length(Assigned_To_is_Running_User__c::varchar)) between 21 and 40 then 50 when max(length(Assigned_To_is_Running_User__c::varchar)) between 41 and 70 then 100 when max(length(Assigned_To_is_Running_User__c::varchar)) between 71 and 200 then 250 when max(length(Assigned_To_is_Running_User__c::varchar)) between 201 and 400 then 500 when max(length(Assigned_To_is_Running_User__c::varchar)) between 401 and 700 then 1000 when max(length(Assigned_To_is_Running_User__c::varchar)) between 701 and 1700 then 2000 when max(length(Assigned_To_is_Running_User__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Assigned_To_is_Running_User__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Assigned_To_is_Running_User__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 75 "position", 'Days_Overdue__c' column_name, count(1) cnt, max(length(Days_Overdue__c::varchar)) max_col_len, case when max(length(Days_Overdue__c::varchar)) < 20 then 20 when max(length(Days_Overdue__c::varchar)) between 21 and 40 then 50 when max(length(Days_Overdue__c::varchar)) between 41 and 70 then 100 when max(length(Days_Overdue__c::varchar)) between 71 and 200 then 250 when max(length(Days_Overdue__c::varchar)) between 201 and 400 then 500 when max(length(Days_Overdue__c::varchar)) between 401 and 700 then 1000 when max(length(Days_Overdue__c::varchar)) between 701 and 1700 then 2000 when max(length(Days_Overdue__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Days_Overdue__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Days_Overdue__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Days_Overdue__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Days_Overdue__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Days_Overdue__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Days_Overdue__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Days_Overdue__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Days_Overdue__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Days_Overdue__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Days_Overdue__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 76 "position", 'Assigned_To_is_Running_User_s_Manager__c' column_name, count(1) cnt, max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) max_col_len, case when max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) < 20 then 20 when max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) between 21 and 40 then 50 when max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) between 41 and 70 then 100 when max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) between 71 and 200 then 250 when max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) between 201 and 400 then 500 when max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) between 401 and 700 then 1000 when max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) between 701 and 1700 then 2000 when max(length(Assigned_To_is_Running_User_s_Manager__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User_s_Manager__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User_s_Manager__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User_s_Manager__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User_s_Manager__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User_s_Manager__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User_s_Manager__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User_s_Manager__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Assigned_To_is_Running_User_s_Manager__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Assigned_To_is_Running_User_s_Manager__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Assigned_To_is_Running_User_s_Manager__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 77 "position", 'Interaction_Disposition__c' column_name, count(1) cnt, max(length(Interaction_Disposition__c::varchar)) max_col_len, case when max(length(Interaction_Disposition__c::varchar)) < 20 then 20 when max(length(Interaction_Disposition__c::varchar)) between 21 and 40 then 50 when max(length(Interaction_Disposition__c::varchar)) between 41 and 70 then 100 when max(length(Interaction_Disposition__c::varchar)) between 71 and 200 then 250 when max(length(Interaction_Disposition__c::varchar)) between 201 and 400 then 500 when max(length(Interaction_Disposition__c::varchar)) between 401 and 700 then 1000 when max(length(Interaction_Disposition__c::varchar)) between 701 and 1700 then 2000 when max(length(Interaction_Disposition__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Disposition__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Disposition__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Disposition__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Disposition__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Disposition__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Disposition__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Disposition__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Interaction_Disposition__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Interaction_Disposition__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Interaction_Disposition__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 78 "position", 'Additional_Comments__c' column_name, count(1) cnt, max(length(Additional_Comments__c::varchar)) max_col_len, case when max(length(Additional_Comments__c::varchar)) < 20 then 20 when max(length(Additional_Comments__c::varchar)) between 21 and 40 then 50 when max(length(Additional_Comments__c::varchar)) between 41 and 70 then 100 when max(length(Additional_Comments__c::varchar)) between 71 and 200 then 250 when max(length(Additional_Comments__c::varchar)) between 201 and 400 then 500 when max(length(Additional_Comments__c::varchar)) between 401 and 700 then 1000 when max(length(Additional_Comments__c::varchar)) between 701 and 1700 then 2000 when max(length(Additional_Comments__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Additional_Comments__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Additional_Comments__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Additional_Comments__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Additional_Comments__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Additional_Comments__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Additional_Comments__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Additional_Comments__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Additional_Comments__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Additional_Comments__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Additional_Comments__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 79 "position", 'Budgetary_Guideline_Notes__c' column_name, count(1) cnt, max(length(Budgetary_Guideline_Notes__c::varchar)) max_col_len, case when max(length(Budgetary_Guideline_Notes__c::varchar)) < 20 then 20 when max(length(Budgetary_Guideline_Notes__c::varchar)) between 21 and 40 then 50 when max(length(Budgetary_Guideline_Notes__c::varchar)) between 41 and 70 then 100 when max(length(Budgetary_Guideline_Notes__c::varchar)) between 71 and 200 then 250 when max(length(Budgetary_Guideline_Notes__c::varchar)) between 201 and 400 then 500 when max(length(Budgetary_Guideline_Notes__c::varchar)) between 401 and 700 then 1000 when max(length(Budgetary_Guideline_Notes__c::varchar)) between 701 and 1700 then 2000 when max(length(Budgetary_Guideline_Notes__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Budgetary_Guideline_Notes__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Budgetary_Guideline_Notes__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Budgetary_Guideline_Notes__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Budgetary_Guideline_Notes__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Budgetary_Guideline_Notes__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Budgetary_Guideline_Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Budgetary_Guideline_Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Budgetary_Guideline_Notes__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Budgetary_Guideline_Notes__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Budgetary_Guideline_Notes__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 80 "position", 'Creative_Guideline_Notes__c' column_name, count(1) cnt, max(length(Creative_Guideline_Notes__c::varchar)) max_col_len, case when max(length(Creative_Guideline_Notes__c::varchar)) < 20 then 20 when max(length(Creative_Guideline_Notes__c::varchar)) between 21 and 40 then 50 when max(length(Creative_Guideline_Notes__c::varchar)) between 41 and 70 then 100 when max(length(Creative_Guideline_Notes__c::varchar)) between 71 and 200 then 250 when max(length(Creative_Guideline_Notes__c::varchar)) between 201 and 400 then 500 when max(length(Creative_Guideline_Notes__c::varchar)) between 401 and 700 then 1000 when max(length(Creative_Guideline_Notes__c::varchar)) between 701 and 1700 then 2000 when max(length(Creative_Guideline_Notes__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Creative_Guideline_Notes__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Creative_Guideline_Notes__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Creative_Guideline_Notes__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Creative_Guideline_Notes__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Creative_Guideline_Notes__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Creative_Guideline_Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Creative_Guideline_Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Creative_Guideline_Notes__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Creative_Guideline_Notes__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Creative_Guideline_Notes__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 81 "position", 'Agent_Name__c' column_name, count(1) cnt, max(length(Agent_Name__c::varchar)) max_col_len, case when max(length(Agent_Name__c::varchar)) < 20 then 20 when max(length(Agent_Name__c::varchar)) between 21 and 40 then 50 when max(length(Agent_Name__c::varchar)) between 41 and 70 then 100 when max(length(Agent_Name__c::varchar)) between 71 and 200 then 250 when max(length(Agent_Name__c::varchar)) between 201 and 400 then 500 when max(length(Agent_Name__c::varchar)) between 401 and 700 then 1000 when max(length(Agent_Name__c::varchar)) between 701 and 1700 then 2000 when max(length(Agent_Name__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Agent_Name__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Agent_Name__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Agent_Name__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Agent_Name__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Agent_Name__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Agent_Name__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Agent_Name__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Agent_Name__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Agent_Name__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Agent_Name__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 82 "position", 'Attempt_Date__c' column_name, count(1) cnt, max(length(Attempt_Date__c::varchar)) max_col_len, case when max(length(Attempt_Date__c::varchar)) < 20 then 20 when max(length(Attempt_Date__c::varchar)) between 21 and 40 then 50 when max(length(Attempt_Date__c::varchar)) between 41 and 70 then 100 when max(length(Attempt_Date__c::varchar)) between 71 and 200 then 250 when max(length(Attempt_Date__c::varchar)) between 201 and 400 then 500 when max(length(Attempt_Date__c::varchar)) between 401 and 700 then 1000 when max(length(Attempt_Date__c::varchar)) between 701 and 1700 then 2000 when max(length(Attempt_Date__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Attempt_Date__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Attempt_Date__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Attempt_Date__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Attempt_Date__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Attempt_Date__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Attempt_Date__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Attempt_Date__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Attempt_Date__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Attempt_Date__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Attempt_Date__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 83 "position", 'CXG_Account__c' column_name, count(1) cnt, max(length(CXG_Account__c::varchar)) max_col_len, case when max(length(CXG_Account__c::varchar)) < 20 then 20 when max(length(CXG_Account__c::varchar)) between 21 and 40 then 50 when max(length(CXG_Account__c::varchar)) between 41 and 70 then 100 when max(length(CXG_Account__c::varchar)) between 71 and 200 then 250 when max(length(CXG_Account__c::varchar)) between 201 and 400 then 500 when max(length(CXG_Account__c::varchar)) between 401 and 700 then 1000 when max(length(CXG_Account__c::varchar)) between 701 and 1700 then 2000 when max(length(CXG_Account__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CXG_Account__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CXG_Account__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CXG_Account__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CXG_Account__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CXG_Account__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CXG_Account__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CXG_Account__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CXG_Account__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CXG_Account__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CXG_Account__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 84 "position", 'CXG_Script_Notes__c' column_name, count(1) cnt, max(length(CXG_Script_Notes__c::varchar)) max_col_len, case when max(length(CXG_Script_Notes__c::varchar)) < 20 then 20 when max(length(CXG_Script_Notes__c::varchar)) between 21 and 40 then 50 when max(length(CXG_Script_Notes__c::varchar)) between 41 and 70 then 100 when max(length(CXG_Script_Notes__c::varchar)) between 71 and 200 then 250 when max(length(CXG_Script_Notes__c::varchar)) between 201 and 400 then 500 when max(length(CXG_Script_Notes__c::varchar)) between 401 and 700 then 1000 when max(length(CXG_Script_Notes__c::varchar)) between 701 and 1700 then 2000 when max(length(CXG_Script_Notes__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CXG_Script_Notes__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CXG_Script_Notes__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CXG_Script_Notes__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CXG_Script_Notes__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CXG_Script_Notes__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CXG_Script_Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CXG_Script_Notes__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CXG_Script_Notes__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CXG_Script_Notes__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CXG_Script_Notes__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 85 "position", 'Call_Back_Scheduled__c' column_name, count(1) cnt, max(length(Call_Back_Scheduled__c::varchar)) max_col_len, case when max(length(Call_Back_Scheduled__c::varchar)) < 20 then 20 when max(length(Call_Back_Scheduled__c::varchar)) between 21 and 40 then 50 when max(length(Call_Back_Scheduled__c::varchar)) between 41 and 70 then 100 when max(length(Call_Back_Scheduled__c::varchar)) between 71 and 200 then 250 when max(length(Call_Back_Scheduled__c::varchar)) between 201 and 400 then 500 when max(length(Call_Back_Scheduled__c::varchar)) between 401 and 700 then 1000 when max(length(Call_Back_Scheduled__c::varchar)) between 701 and 1700 then 2000 when max(length(Call_Back_Scheduled__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Call_Back_Scheduled__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Call_Back_Scheduled__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Call_Back_Scheduled__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Call_Back_Scheduled__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Call_Back_Scheduled__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Call_Back_Scheduled__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Call_Back_Scheduled__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Call_Back_Scheduled__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Call_Back_Scheduled__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Call_Back_Scheduled__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 86 "position", 'Call_Resolutions__c' column_name, count(1) cnt, max(length(Call_Resolutions__c::varchar)) max_col_len, case when max(length(Call_Resolutions__c::varchar)) < 20 then 20 when max(length(Call_Resolutions__c::varchar)) between 21 and 40 then 50 when max(length(Call_Resolutions__c::varchar)) between 41 and 70 then 100 when max(length(Call_Resolutions__c::varchar)) between 71 and 200 then 250 when max(length(Call_Resolutions__c::varchar)) between 201 and 400 then 500 when max(length(Call_Resolutions__c::varchar)) between 401 and 700 then 1000 when max(length(Call_Resolutions__c::varchar)) between 701 and 1700 then 2000 when max(length(Call_Resolutions__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Call_Resolutions__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Call_Resolutions__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Call_Resolutions__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Call_Resolutions__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Call_Resolutions__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Call_Resolutions__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Call_Resolutions__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Call_Resolutions__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Call_Resolutions__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Call_Resolutions__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 87 "position", 'Campaign_Member_ID__c' column_name, count(1) cnt, max(length(Campaign_Member_ID__c::varchar)) max_col_len, case when max(length(Campaign_Member_ID__c::varchar)) < 20 then 20 when max(length(Campaign_Member_ID__c::varchar)) between 21 and 40 then 50 when max(length(Campaign_Member_ID__c::varchar)) between 41 and 70 then 100 when max(length(Campaign_Member_ID__c::varchar)) between 71 and 200 then 250 when max(length(Campaign_Member_ID__c::varchar)) between 201 and 400 then 500 when max(length(Campaign_Member_ID__c::varchar)) between 401 and 700 then 1000 when max(length(Campaign_Member_ID__c::varchar)) between 701 and 1700 then 2000 when max(length(Campaign_Member_ID__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Campaign_Member_ID__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Campaign_Member_ID__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Campaign_Member_ID__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Campaign_Member_ID__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Campaign_Member_ID__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Campaign_Member_ID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Campaign_Member_ID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Campaign_Member_ID__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Campaign_Member_ID__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Campaign_Member_ID__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 88 "position", 'Campaign__c' column_name, count(1) cnt, max(length(Campaign__c::varchar)) max_col_len, case when max(length(Campaign__c::varchar)) < 20 then 20 when max(length(Campaign__c::varchar)) between 21 and 40 then 50 when max(length(Campaign__c::varchar)) between 41 and 70 then 100 when max(length(Campaign__c::varchar)) between 71 and 200 then 250 when max(length(Campaign__c::varchar)) between 201 and 400 then 500 when max(length(Campaign__c::varchar)) between 401 and 700 then 1000 when max(length(Campaign__c::varchar)) between 701 and 1700 then 2000 when max(length(Campaign__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Campaign__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Campaign__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Campaign__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Campaign__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Campaign__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Campaign__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Campaign__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Campaign__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Campaign__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Campaign__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 89 "position", 'Contacts_VM__c' column_name, count(1) cnt, max(length(Contacts_VM__c::varchar)) max_col_len, case when max(length(Contacts_VM__c::varchar)) < 20 then 20 when max(length(Contacts_VM__c::varchar)) between 21 and 40 then 50 when max(length(Contacts_VM__c::varchar)) between 41 and 70 then 100 when max(length(Contacts_VM__c::varchar)) between 71 and 200 then 250 when max(length(Contacts_VM__c::varchar)) between 201 and 400 then 500 when max(length(Contacts_VM__c::varchar)) between 401 and 700 then 1000 when max(length(Contacts_VM__c::varchar)) between 701 and 1700 then 2000 when max(length(Contacts_VM__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Contacts_VM__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Contacts_VM__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Contacts_VM__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Contacts_VM__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Contacts_VM__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Contacts_VM__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Contacts_VM__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Contacts_VM__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Contacts_VM__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Contacts_VM__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 90 "position", 'Disposition__c' column_name, count(1) cnt, max(length(Disposition__c::varchar)) max_col_len, case when max(length(Disposition__c::varchar)) < 20 then 20 when max(length(Disposition__c::varchar)) between 21 and 40 then 50 when max(length(Disposition__c::varchar)) between 41 and 70 then 100 when max(length(Disposition__c::varchar)) between 71 and 200 then 250 when max(length(Disposition__c::varchar)) between 201 and 400 then 500 when max(length(Disposition__c::varchar)) between 401 and 700 then 1000 when max(length(Disposition__c::varchar)) between 701 and 1700 then 2000 when max(length(Disposition__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Disposition__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Disposition__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Disposition__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Disposition__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Disposition__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Disposition__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Disposition__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Disposition__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Disposition__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Disposition__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 91 "position", 'IsContacted__c' column_name, count(1) cnt, max(length(IsContacted__c::varchar)) max_col_len, case when max(length(IsContacted__c::varchar)) < 20 then 20 when max(length(IsContacted__c::varchar)) between 21 and 40 then 50 when max(length(IsContacted__c::varchar)) between 41 and 70 then 100 when max(length(IsContacted__c::varchar)) between 71 and 200 then 250 when max(length(IsContacted__c::varchar)) between 201 and 400 then 500 when max(length(IsContacted__c::varchar)) between 401 and 700 then 1000 when max(length(IsContacted__c::varchar)) between 701 and 1700 then 2000 when max(length(IsContacted__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(IsContacted__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(IsContacted__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(IsContacted__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(IsContacted__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(IsContacted__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(IsContacted__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(IsContacted__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(IsContacted__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(IsContacted__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN IsContacted__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 92 "position", 'Issue_Identified__c' column_name, count(1) cnt, max(length(Issue_Identified__c::varchar)) max_col_len, case when max(length(Issue_Identified__c::varchar)) < 20 then 20 when max(length(Issue_Identified__c::varchar)) between 21 and 40 then 50 when max(length(Issue_Identified__c::varchar)) between 41 and 70 then 100 when max(length(Issue_Identified__c::varchar)) between 71 and 200 then 250 when max(length(Issue_Identified__c::varchar)) between 201 and 400 then 500 when max(length(Issue_Identified__c::varchar)) between 401 and 700 then 1000 when max(length(Issue_Identified__c::varchar)) between 701 and 1700 then 2000 when max(length(Issue_Identified__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Issue_Identified__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Issue_Identified__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Issue_Identified__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Issue_Identified__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Issue_Identified__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Issue_Identified__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Issue_Identified__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Issue_Identified__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Issue_Identified__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Issue_Identified__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 93 "position", 'Issue__c' column_name, count(1) cnt, max(length(Issue__c::varchar)) max_col_len, case when max(length(Issue__c::varchar)) < 20 then 20 when max(length(Issue__c::varchar)) between 21 and 40 then 50 when max(length(Issue__c::varchar)) between 41 and 70 then 100 when max(length(Issue__c::varchar)) between 71 and 200 then 250 when max(length(Issue__c::varchar)) between 201 and 400 then 500 when max(length(Issue__c::varchar)) between 401 and 700 then 1000 when max(length(Issue__c::varchar)) between 701 and 1700 then 2000 when max(length(Issue__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Issue__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Issue__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Issue__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Issue__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Issue__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Issue__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Issue__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Issue__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Issue__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Issue__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 94 "position", 'Line_Disconnected_Fax__c' column_name, count(1) cnt, max(length(Line_Disconnected_Fax__c::varchar)) max_col_len, case when max(length(Line_Disconnected_Fax__c::varchar)) < 20 then 20 when max(length(Line_Disconnected_Fax__c::varchar)) between 21 and 40 then 50 when max(length(Line_Disconnected_Fax__c::varchar)) between 41 and 70 then 100 when max(length(Line_Disconnected_Fax__c::varchar)) between 71 and 200 then 250 when max(length(Line_Disconnected_Fax__c::varchar)) between 201 and 400 then 500 when max(length(Line_Disconnected_Fax__c::varchar)) between 401 and 700 then 1000 when max(length(Line_Disconnected_Fax__c::varchar)) between 701 and 1700 then 2000 when max(length(Line_Disconnected_Fax__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Line_Disconnected_Fax__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Line_Disconnected_Fax__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Line_Disconnected_Fax__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Line_Disconnected_Fax__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Line_Disconnected_Fax__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Line_Disconnected_Fax__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Line_Disconnected_Fax__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Line_Disconnected_Fax__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Line_Disconnected_Fax__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Line_Disconnected_Fax__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 95 "position", 'Month_Year__c' column_name, count(1) cnt, max(length(Month_Year__c::varchar)) max_col_len, case when max(length(Month_Year__c::varchar)) < 20 then 20 when max(length(Month_Year__c::varchar)) between 21 and 40 then 50 when max(length(Month_Year__c::varchar)) between 41 and 70 then 100 when max(length(Month_Year__c::varchar)) between 71 and 200 then 250 when max(length(Month_Year__c::varchar)) between 201 and 400 then 500 when max(length(Month_Year__c::varchar)) between 401 and 700 then 1000 when max(length(Month_Year__c::varchar)) between 701 and 1700 then 2000 when max(length(Month_Year__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Month_Year__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Month_Year__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Month_Year__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Month_Year__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Month_Year__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Month_Year__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Month_Year__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Month_Year__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Month_Year__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Month_Year__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 96 "position", 'Ring_No_Answer_Busy__c' column_name, count(1) cnt, max(length(Ring_No_Answer_Busy__c::varchar)) max_col_len, case when max(length(Ring_No_Answer_Busy__c::varchar)) < 20 then 20 when max(length(Ring_No_Answer_Busy__c::varchar)) between 21 and 40 then 50 when max(length(Ring_No_Answer_Busy__c::varchar)) between 41 and 70 then 100 when max(length(Ring_No_Answer_Busy__c::varchar)) between 71 and 200 then 250 when max(length(Ring_No_Answer_Busy__c::varchar)) between 201 and 400 then 500 when max(length(Ring_No_Answer_Busy__c::varchar)) between 401 and 700 then 1000 when max(length(Ring_No_Answer_Busy__c::varchar)) between 701 and 1700 then 2000 when max(length(Ring_No_Answer_Busy__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Ring_No_Answer_Busy__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Ring_No_Answer_Busy__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Ring_No_Answer_Busy__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Ring_No_Answer_Busy__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Ring_No_Answer_Busy__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Ring_No_Answer_Busy__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Ring_No_Answer_Busy__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Ring_No_Answer_Busy__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Ring_No_Answer_Busy__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Ring_No_Answer_Busy__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 97 "position", 'Sub_Issue__c' column_name, count(1) cnt, max(length(Sub_Issue__c::varchar)) max_col_len, case when max(length(Sub_Issue__c::varchar)) < 20 then 20 when max(length(Sub_Issue__c::varchar)) between 21 and 40 then 50 when max(length(Sub_Issue__c::varchar)) between 41 and 70 then 100 when max(length(Sub_Issue__c::varchar)) between 71 and 200 then 250 when max(length(Sub_Issue__c::varchar)) between 201 and 400 then 500 when max(length(Sub_Issue__c::varchar)) between 401 and 700 then 1000 when max(length(Sub_Issue__c::varchar)) between 701 and 1700 then 2000 when max(length(Sub_Issue__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Sub_Issue__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Sub_Issue__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Sub_Issue__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Sub_Issue__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Sub_Issue__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Sub_Issue__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Sub_Issue__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Sub_Issue__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Sub_Issue__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Sub_Issue__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 98 "position", 'Owner_Manager__c' column_name, count(1) cnt, max(length(Owner_Manager__c::varchar)) max_col_len, case when max(length(Owner_Manager__c::varchar)) < 20 then 20 when max(length(Owner_Manager__c::varchar)) between 21 and 40 then 50 when max(length(Owner_Manager__c::varchar)) between 41 and 70 then 100 when max(length(Owner_Manager__c::varchar)) between 71 and 200 then 250 when max(length(Owner_Manager__c::varchar)) between 201 and 400 then 500 when max(length(Owner_Manager__c::varchar)) between 401 and 700 then 1000 when max(length(Owner_Manager__c::varchar)) between 701 and 1700 then 2000 when max(length(Owner_Manager__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Owner_Manager__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Owner_Manager__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Owner_Manager__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Owner_Manager__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Owner_Manager__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Owner_Manager__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Owner_Manager__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Owner_Manager__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Owner_Manager__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Owner_Manager__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 99 "position", 'Non_CTI__c' column_name, count(1) cnt, max(length(Non_CTI__c::varchar)) max_col_len, case when max(length(Non_CTI__c::varchar)) < 20 then 20 when max(length(Non_CTI__c::varchar)) between 21 and 40 then 50 when max(length(Non_CTI__c::varchar)) between 41 and 70 then 100 when max(length(Non_CTI__c::varchar)) between 71 and 200 then 250 when max(length(Non_CTI__c::varchar)) between 201 and 400 then 500 when max(length(Non_CTI__c::varchar)) between 401 and 700 then 1000 when max(length(Non_CTI__c::varchar)) between 701 and 1700 then 2000 when max(length(Non_CTI__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Non_CTI__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Non_CTI__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Non_CTI__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Non_CTI__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Non_CTI__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Non_CTI__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Non_CTI__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Non_CTI__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Non_CTI__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Non_CTI__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 100 "position", 'SFA_Office_Code__c' column_name, count(1) cnt, max(length(SFA_Office_Code__c::varchar)) max_col_len, case when max(length(SFA_Office_Code__c::varchar)) < 20 then 20 when max(length(SFA_Office_Code__c::varchar)) between 21 and 40 then 50 when max(length(SFA_Office_Code__c::varchar)) between 41 and 70 then 100 when max(length(SFA_Office_Code__c::varchar)) between 71 and 200 then 250 when max(length(SFA_Office_Code__c::varchar)) between 201 and 400 then 500 when max(length(SFA_Office_Code__c::varchar)) between 401 and 700 then 1000 when max(length(SFA_Office_Code__c::varchar)) between 701 and 1700 then 2000 when max(length(SFA_Office_Code__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Code__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Code__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Code__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Code__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Code__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Code__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Code__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Code__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(SFA_Office_Code__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN SFA_Office_Code__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 101 "position", 'SFA_Office_Name__c' column_name, count(1) cnt, max(length(SFA_Office_Name__c::varchar)) max_col_len, case when max(length(SFA_Office_Name__c::varchar)) < 20 then 20 when max(length(SFA_Office_Name__c::varchar)) between 21 and 40 then 50 when max(length(SFA_Office_Name__c::varchar)) between 41 and 70 then 100 when max(length(SFA_Office_Name__c::varchar)) between 71 and 200 then 250 when max(length(SFA_Office_Name__c::varchar)) between 201 and 400 then 500 when max(length(SFA_Office_Name__c::varchar)) between 401 and 700 then 1000 when max(length(SFA_Office_Name__c::varchar)) between 701 and 1700 then 2000 when max(length(SFA_Office_Name__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Name__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Name__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Name__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Name__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Name__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Name__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Name__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(SFA_Office_Name__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(SFA_Office_Name__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN SFA_Office_Name__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 102 "position", 'Primary_Owner_AFrontier_Employee_ID__c' column_name, count(1) cnt, max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) max_col_len, case when max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) < 20 then 20 when max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) between 21 and 40 then 50 when max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) between 41 and 70 then 100 when max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) between 71 and 200 then 250 when max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) between 201 and 400 then 500 when max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) between 401 and 700 then 1000 when max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) between 701 and 1700 then 2000 when max(length(Primary_Owner_AFrontier_Employee_ID__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_AFrontier_Employee_ID__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_AFrontier_Employee_ID__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_AFrontier_Employee_ID__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_AFrontier_Employee_ID__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_AFrontier_Employee_ID__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_AFrontier_Employee_ID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_AFrontier_Employee_ID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_AFrontier_Employee_ID__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Primary_Owner_AFrontier_Employee_ID__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Primary_Owner_AFrontier_Employee_ID__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 103 "position", 'Primary_Owner_ATTUID__c' column_name, count(1) cnt, max(length(Primary_Owner_ATTUID__c::varchar)) max_col_len, case when max(length(Primary_Owner_ATTUID__c::varchar)) < 20 then 20 when max(length(Primary_Owner_ATTUID__c::varchar)) between 21 and 40 then 50 when max(length(Primary_Owner_ATTUID__c::varchar)) between 41 and 70 then 100 when max(length(Primary_Owner_ATTUID__c::varchar)) between 71 and 200 then 250 when max(length(Primary_Owner_ATTUID__c::varchar)) between 201 and 400 then 500 when max(length(Primary_Owner_ATTUID__c::varchar)) between 401 and 700 then 1000 when max(length(Primary_Owner_ATTUID__c::varchar)) between 701 and 1700 then 2000 when max(length(Primary_Owner_ATTUID__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_ATTUID__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_ATTUID__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_ATTUID__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_ATTUID__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_ATTUID__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_ATTUID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_ATTUID__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Primary_Owner_ATTUID__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Primary_Owner_ATTUID__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Primary_Owner_ATTUID__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 104 "position", 'ANI__c' column_name, count(1) cnt, max(length(ANI__c::varchar)) max_col_len, case when max(length(ANI__c::varchar)) < 20 then 20 when max(length(ANI__c::varchar)) between 21 and 40 then 50 when max(length(ANI__c::varchar)) between 41 and 70 then 100 when max(length(ANI__c::varchar)) between 71 and 200 then 250 when max(length(ANI__c::varchar)) between 201 and 400 then 500 when max(length(ANI__c::varchar)) between 401 and 700 then 1000 when max(length(ANI__c::varchar)) between 701 and 1700 then 2000 when max(length(ANI__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(ANI__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(ANI__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(ANI__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(ANI__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(ANI__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(ANI__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(ANI__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(ANI__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(ANI__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN ANI__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 105 "position", 'CallBy__c' column_name, count(1) cnt, max(length(CallBy__c::varchar)) max_col_len, case when max(length(CallBy__c::varchar)) < 20 then 20 when max(length(CallBy__c::varchar)) between 21 and 40 then 50 when max(length(CallBy__c::varchar)) between 41 and 70 then 100 when max(length(CallBy__c::varchar)) between 71 and 200 then 250 when max(length(CallBy__c::varchar)) between 201 and 400 then 500 when max(length(CallBy__c::varchar)) between 401 and 700 then 1000 when max(length(CallBy__c::varchar)) between 701 and 1700 then 2000 when max(length(CallBy__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CallBy__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CallBy__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CallBy__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CallBy__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CallBy__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CallBy__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CallBy__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CallBy__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CallBy__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CallBy__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 106 "position", 'DispositionReason__c' column_name, count(1) cnt, max(length(DispositionReason__c::varchar)) max_col_len, case when max(length(DispositionReason__c::varchar)) < 20 then 20 when max(length(DispositionReason__c::varchar)) between 21 and 40 then 50 when max(length(DispositionReason__c::varchar)) between 41 and 70 then 100 when max(length(DispositionReason__c::varchar)) between 71 and 200 then 250 when max(length(DispositionReason__c::varchar)) between 201 and 400 then 500 when max(length(DispositionReason__c::varchar)) between 401 and 700 then 1000 when max(length(DispositionReason__c::varchar)) between 701 and 1700 then 2000 when max(length(DispositionReason__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(DispositionReason__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(DispositionReason__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(DispositionReason__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(DispositionReason__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(DispositionReason__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(DispositionReason__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(DispositionReason__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(DispositionReason__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(DispositionReason__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN DispositionReason__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 107 "position", 'Duration__c' column_name, count(1) cnt, max(length(Duration__c::varchar)) max_col_len, case when max(length(Duration__c::varchar)) < 20 then 20 when max(length(Duration__c::varchar)) between 21 and 40 then 50 when max(length(Duration__c::varchar)) between 41 and 70 then 100 when max(length(Duration__c::varchar)) between 71 and 200 then 250 when max(length(Duration__c::varchar)) between 201 and 400 then 500 when max(length(Duration__c::varchar)) between 401 and 700 then 1000 when max(length(Duration__c::varchar)) between 701 and 1700 then 2000 when max(length(Duration__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Duration__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Duration__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Duration__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Duration__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Duration__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Duration__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Duration__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Duration__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Duration__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Duration__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 108 "position", 'EndTime__c' column_name, count(1) cnt, max(length(EndTime__c::varchar)) max_col_len, case when max(length(EndTime__c::varchar)) < 20 then 20 when max(length(EndTime__c::varchar)) between 21 and 40 then 50 when max(length(EndTime__c::varchar)) between 41 and 70 then 100 when max(length(EndTime__c::varchar)) between 71 and 200 then 250 when max(length(EndTime__c::varchar)) between 201 and 400 then 500 when max(length(EndTime__c::varchar)) between 401 and 700 then 1000 when max(length(EndTime__c::varchar)) between 701 and 1700 then 2000 when max(length(EndTime__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(EndTime__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(EndTime__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(EndTime__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(EndTime__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(EndTime__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(EndTime__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(EndTime__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(EndTime__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(EndTime__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN EndTime__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 109 "position", 'FollowUpDate__c' column_name, count(1) cnt, max(length(FollowUpDate__c::varchar)) max_col_len, case when max(length(FollowUpDate__c::varchar)) < 20 then 20 when max(length(FollowUpDate__c::varchar)) between 21 and 40 then 50 when max(length(FollowUpDate__c::varchar)) between 41 and 70 then 100 when max(length(FollowUpDate__c::varchar)) between 71 and 200 then 250 when max(length(FollowUpDate__c::varchar)) between 201 and 400 then 500 when max(length(FollowUpDate__c::varchar)) between 401 and 700 then 1000 when max(length(FollowUpDate__c::varchar)) between 701 and 1700 then 2000 when max(length(FollowUpDate__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(FollowUpDate__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(FollowUpDate__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(FollowUpDate__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(FollowUpDate__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(FollowUpDate__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(FollowUpDate__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(FollowUpDate__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(FollowUpDate__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(FollowUpDate__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN FollowUpDate__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 110 "position", 'StartTime__c' column_name, count(1) cnt, max(length(StartTime__c::varchar)) max_col_len, case when max(length(StartTime__c::varchar)) < 20 then 20 when max(length(StartTime__c::varchar)) between 21 and 40 then 50 when max(length(StartTime__c::varchar)) between 41 and 70 then 100 when max(length(StartTime__c::varchar)) between 71 and 200 then 250 when max(length(StartTime__c::varchar)) between 201 and 400 then 500 when max(length(StartTime__c::varchar)) between 401 and 700 then 1000 when max(length(StartTime__c::varchar)) between 701 and 1700 then 2000 when max(length(StartTime__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(StartTime__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(StartTime__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(StartTime__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(StartTime__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(StartTime__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(StartTime__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(StartTime__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(StartTime__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(StartTime__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN StartTime__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 111 "position", 'Type__c' column_name, count(1) cnt, max(length(Type__c::varchar)) max_col_len, case when max(length(Type__c::varchar)) < 20 then 20 when max(length(Type__c::varchar)) between 21 and 40 then 50 when max(length(Type__c::varchar)) between 41 and 70 then 100 when max(length(Type__c::varchar)) between 71 and 200 then 250 when max(length(Type__c::varchar)) between 201 and 400 then 500 when max(length(Type__c::varchar)) between 401 and 700 then 1000 when max(length(Type__c::varchar)) between 701 and 1700 then 2000 when max(length(Type__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Type__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Type__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Type__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Type__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Type__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Type__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Type__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Type__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 112 "position", 'Wrap_up_time__c' column_name, count(1) cnt, max(length(Wrap_up_time__c::varchar)) max_col_len, case when max(length(Wrap_up_time__c::varchar)) < 20 then 20 when max(length(Wrap_up_time__c::varchar)) between 21 and 40 then 50 when max(length(Wrap_up_time__c::varchar)) between 41 and 70 then 100 when max(length(Wrap_up_time__c::varchar)) between 71 and 200 then 250 when max(length(Wrap_up_time__c::varchar)) between 201 and 400 then 500 when max(length(Wrap_up_time__c::varchar)) between 401 and 700 then 1000 when max(length(Wrap_up_time__c::varchar)) between 701 and 1700 then 2000 when max(length(Wrap_up_time__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Wrap_up_time__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Wrap_up_time__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 113 "position", 'CampaignName__c' column_name, count(1) cnt, max(length(CampaignName__c::varchar)) max_col_len, case when max(length(CampaignName__c::varchar)) < 20 then 20 when max(length(CampaignName__c::varchar)) between 21 and 40 then 50 when max(length(CampaignName__c::varchar)) between 41 and 70 then 100 when max(length(CampaignName__c::varchar)) between 71 and 200 then 250 when max(length(CampaignName__c::varchar)) between 201 and 400 then 500 when max(length(CampaignName__c::varchar)) between 401 and 700 then 1000 when max(length(CampaignName__c::varchar)) between 701 and 1700 then 2000 when max(length(CampaignName__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CampaignName__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CampaignName__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CampaignName__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CampaignName__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CampaignName__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CampaignName__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CampaignName__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CampaignName__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CampaignName__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CampaignName__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 114 "position", 'LeadPhone__c' column_name, count(1) cnt, max(length(LeadPhone__c::varchar)) max_col_len, case when max(length(LeadPhone__c::varchar)) < 20 then 20 when max(length(LeadPhone__c::varchar)) between 21 and 40 then 50 when max(length(LeadPhone__c::varchar)) between 41 and 70 then 100 when max(length(LeadPhone__c::varchar)) between 71 and 200 then 250 when max(length(LeadPhone__c::varchar)) between 201 and 400 then 500 when max(length(LeadPhone__c::varchar)) between 401 and 700 then 1000 when max(length(LeadPhone__c::varchar)) between 701 and 1700 then 2000 when max(length(LeadPhone__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(LeadPhone__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(LeadPhone__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(LeadPhone__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(LeadPhone__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(LeadPhone__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(LeadPhone__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(LeadPhone__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(LeadPhone__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(LeadPhone__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN LeadPhone__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 115 "position", 'Query_Id__c' column_name, count(1) cnt, max(length(Query_Id__c::varchar)) max_col_len, case when max(length(Query_Id__c::varchar)) < 20 then 20 when max(length(Query_Id__c::varchar)) between 21 and 40 then 50 when max(length(Query_Id__c::varchar)) between 41 and 70 then 100 when max(length(Query_Id__c::varchar)) between 71 and 200 then 250 when max(length(Query_Id__c::varchar)) between 201 and 400 then 500 when max(length(Query_Id__c::varchar)) between 401 and 700 then 1000 when max(length(Query_Id__c::varchar)) between 701 and 1700 then 2000 when max(length(Query_Id__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Query_Id__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Query_Id__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Query_Id__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Query_Id__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Query_Id__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Query_Id__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Query_Id__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Query_Id__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Query_Id__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Query_Id__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 116 "position", 'Leadlink__c' column_name, count(1) cnt, max(length(Leadlink__c::varchar)) max_col_len, case when max(length(Leadlink__c::varchar)) < 20 then 20 when max(length(Leadlink__c::varchar)) between 21 and 40 then 50 when max(length(Leadlink__c::varchar)) between 41 and 70 then 100 when max(length(Leadlink__c::varchar)) between 71 and 200 then 250 when max(length(Leadlink__c::varchar)) between 201 and 400 then 500 when max(length(Leadlink__c::varchar)) between 401 and 700 then 1000 when max(length(Leadlink__c::varchar)) between 701 and 1700 then 2000 when max(length(Leadlink__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Leadlink__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Leadlink__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Leadlink__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Leadlink__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Leadlink__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Leadlink__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Leadlink__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Leadlink__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Leadlink__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Leadlink__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 117 "position", 'No_of_Pitches__c' column_name, count(1) cnt, max(length(No_of_Pitches__c::varchar)) max_col_len, case when max(length(No_of_Pitches__c::varchar)) < 20 then 20 when max(length(No_of_Pitches__c::varchar)) between 21 and 40 then 50 when max(length(No_of_Pitches__c::varchar)) between 41 and 70 then 100 when max(length(No_of_Pitches__c::varchar)) between 71 and 200 then 250 when max(length(No_of_Pitches__c::varchar)) between 201 and 400 then 500 when max(length(No_of_Pitches__c::varchar)) between 401 and 700 then 1000 when max(length(No_of_Pitches__c::varchar)) between 701 and 1700 then 2000 when max(length(No_of_Pitches__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(No_of_Pitches__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(No_of_Pitches__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(No_of_Pitches__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(No_of_Pitches__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(No_of_Pitches__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(No_of_Pitches__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(No_of_Pitches__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(No_of_Pitches__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(No_of_Pitches__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN No_of_Pitches__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 118 "position", 'CustomCreatedDate__c' column_name, count(1) cnt, max(length(CustomCreatedDate__c::varchar)) max_col_len, case when max(length(CustomCreatedDate__c::varchar)) < 20 then 20 when max(length(CustomCreatedDate__c::varchar)) between 21 and 40 then 50 when max(length(CustomCreatedDate__c::varchar)) between 41 and 70 then 100 when max(length(CustomCreatedDate__c::varchar)) between 71 and 200 then 250 when max(length(CustomCreatedDate__c::varchar)) between 201 and 400 then 500 when max(length(CustomCreatedDate__c::varchar)) between 401 and 700 then 1000 when max(length(CustomCreatedDate__c::varchar)) between 701 and 1700 then 2000 when max(length(CustomCreatedDate__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(CustomCreatedDate__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(CustomCreatedDate__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(CustomCreatedDate__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(CustomCreatedDate__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(CustomCreatedDate__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(CustomCreatedDate__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(CustomCreatedDate__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(CustomCreatedDate__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(CustomCreatedDate__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN CustomCreatedDate__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 119 "position", 'Wrap_up_time_Seconds__c' column_name, count(1) cnt, max(length(Wrap_up_time_Seconds__c::varchar)) max_col_len, case when max(length(Wrap_up_time_Seconds__c::varchar)) < 20 then 20 when max(length(Wrap_up_time_Seconds__c::varchar)) between 21 and 40 then 50 when max(length(Wrap_up_time_Seconds__c::varchar)) between 41 and 70 then 100 when max(length(Wrap_up_time_Seconds__c::varchar)) between 71 and 200 then 250 when max(length(Wrap_up_time_Seconds__c::varchar)) between 201 and 400 then 500 when max(length(Wrap_up_time_Seconds__c::varchar)) between 401 and 700 then 1000 when max(length(Wrap_up_time_Seconds__c::varchar)) between 701 and 1700 then 2000 when max(length(Wrap_up_time_Seconds__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time_Seconds__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time_Seconds__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time_Seconds__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time_Seconds__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time_Seconds__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time_Seconds__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time_Seconds__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Wrap_up_time_Seconds__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Wrap_up_time_Seconds__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Wrap_up_time_Seconds__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 120 "position", 'Disposition_Massini__c' column_name, count(1) cnt, max(length(Disposition_Massini__c::varchar)) max_col_len, case when max(length(Disposition_Massini__c::varchar)) < 20 then 20 when max(length(Disposition_Massini__c::varchar)) between 21 and 40 then 50 when max(length(Disposition_Massini__c::varchar)) between 41 and 70 then 100 when max(length(Disposition_Massini__c::varchar)) between 71 and 200 then 250 when max(length(Disposition_Massini__c::varchar)) between 201 and 400 then 500 when max(length(Disposition_Massini__c::varchar)) between 401 and 700 then 1000 when max(length(Disposition_Massini__c::varchar)) between 701 and 1700 then 2000 when max(length(Disposition_Massini__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Massini__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Massini__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Massini__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Massini__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Massini__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Massini__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Massini__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Massini__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Disposition_Massini__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Disposition_Massini__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 121 "position", 'Disposition_Reason_Massini__c' column_name, count(1) cnt, max(length(Disposition_Reason_Massini__c::varchar)) max_col_len, case when max(length(Disposition_Reason_Massini__c::varchar)) < 20 then 20 when max(length(Disposition_Reason_Massini__c::varchar)) between 21 and 40 then 50 when max(length(Disposition_Reason_Massini__c::varchar)) between 41 and 70 then 100 when max(length(Disposition_Reason_Massini__c::varchar)) between 71 and 200 then 250 when max(length(Disposition_Reason_Massini__c::varchar)) between 201 and 400 then 500 when max(length(Disposition_Reason_Massini__c::varchar)) between 401 and 700 then 1000 when max(length(Disposition_Reason_Massini__c::varchar)) between 701 and 1700 then 2000 when max(length(Disposition_Reason_Massini__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Reason_Massini__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Reason_Massini__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Reason_Massini__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Reason_Massini__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Reason_Massini__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Reason_Massini__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Reason_Massini__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Reason_Massini__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Disposition_Reason_Massini__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Disposition_Reason_Massini__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 122 "position", 'Opportunity_Disposition_Reasons__c' column_name, count(1) cnt, max(length(Opportunity_Disposition_Reasons__c::varchar)) max_col_len, case when max(length(Opportunity_Disposition_Reasons__c::varchar)) < 20 then 20 when max(length(Opportunity_Disposition_Reasons__c::varchar)) between 21 and 40 then 50 when max(length(Opportunity_Disposition_Reasons__c::varchar)) between 41 and 70 then 100 when max(length(Opportunity_Disposition_Reasons__c::varchar)) between 71 and 200 then 250 when max(length(Opportunity_Disposition_Reasons__c::varchar)) between 201 and 400 then 500 when max(length(Opportunity_Disposition_Reasons__c::varchar)) between 401 and 700 then 1000 when max(length(Opportunity_Disposition_Reasons__c::varchar)) between 701 and 1700 then 2000 when max(length(Opportunity_Disposition_Reasons__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition_Reasons__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition_Reasons__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition_Reasons__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition_Reasons__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition_Reasons__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition_Reasons__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition_Reasons__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition_Reasons__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Opportunity_Disposition_Reasons__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Opportunity_Disposition_Reasons__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 123 "position", 'Opportunity_Disposition__c' column_name, count(1) cnt, max(length(Opportunity_Disposition__c::varchar)) max_col_len, case when max(length(Opportunity_Disposition__c::varchar)) < 20 then 20 when max(length(Opportunity_Disposition__c::varchar)) between 21 and 40 then 50 when max(length(Opportunity_Disposition__c::varchar)) between 41 and 70 then 100 when max(length(Opportunity_Disposition__c::varchar)) between 71 and 200 then 250 when max(length(Opportunity_Disposition__c::varchar)) between 201 and 400 then 500 when max(length(Opportunity_Disposition__c::varchar)) between 401 and 700 then 1000 when max(length(Opportunity_Disposition__c::varchar)) between 701 and 1700 then 2000 when max(length(Opportunity_Disposition__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Opportunity_Disposition__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Opportunity_Disposition__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Opportunity_Disposition__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 124 "position", 'Identified_upsell_opportunity__c' column_name, count(1) cnt, max(length(Identified_upsell_opportunity__c::varchar)) max_col_len, case when max(length(Identified_upsell_opportunity__c::varchar)) < 20 then 20 when max(length(Identified_upsell_opportunity__c::varchar)) between 21 and 40 then 50 when max(length(Identified_upsell_opportunity__c::varchar)) between 41 and 70 then 100 when max(length(Identified_upsell_opportunity__c::varchar)) between 71 and 200 then 250 when max(length(Identified_upsell_opportunity__c::varchar)) between 201 and 400 then 500 when max(length(Identified_upsell_opportunity__c::varchar)) between 401 and 700 then 1000 when max(length(Identified_upsell_opportunity__c::varchar)) between 701 and 1700 then 2000 when max(length(Identified_upsell_opportunity__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Identified_upsell_opportunity__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Identified_upsell_opportunity__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Identified_upsell_opportunity__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Identified_upsell_opportunity__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Identified_upsell_opportunity__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Identified_upsell_opportunity__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Identified_upsell_opportunity__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Identified_upsell_opportunity__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Identified_upsell_opportunity__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Identified_upsell_opportunity__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 125 "position", 'Performed_quality_assurance_review__c' column_name, count(1) cnt, max(length(Performed_quality_assurance_review__c::varchar)) max_col_len, case when max(length(Performed_quality_assurance_review__c::varchar)) < 20 then 20 when max(length(Performed_quality_assurance_review__c::varchar)) between 21 and 40 then 50 when max(length(Performed_quality_assurance_review__c::varchar)) between 41 and 70 then 100 when max(length(Performed_quality_assurance_review__c::varchar)) between 71 and 200 then 250 when max(length(Performed_quality_assurance_review__c::varchar)) between 201 and 400 then 500 when max(length(Performed_quality_assurance_review__c::varchar)) between 401 and 700 then 1000 when max(length(Performed_quality_assurance_review__c::varchar)) between 701 and 1700 then 2000 when max(length(Performed_quality_assurance_review__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Performed_quality_assurance_review__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Performed_quality_assurance_review__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Performed_quality_assurance_review__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Performed_quality_assurance_review__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Performed_quality_assurance_review__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Performed_quality_assurance_review__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Performed_quality_assurance_review__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Performed_quality_assurance_review__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Performed_quality_assurance_review__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Performed_quality_assurance_review__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 126 "position", 'Presented_proposal_for_next_contract__c' column_name, count(1) cnt, max(length(Presented_proposal_for_next_contract__c::varchar)) max_col_len, case when max(length(Presented_proposal_for_next_contract__c::varchar)) < 20 then 20 when max(length(Presented_proposal_for_next_contract__c::varchar)) between 21 and 40 then 50 when max(length(Presented_proposal_for_next_contract__c::varchar)) between 41 and 70 then 100 when max(length(Presented_proposal_for_next_contract__c::varchar)) between 71 and 200 then 250 when max(length(Presented_proposal_for_next_contract__c::varchar)) between 201 and 400 then 500 when max(length(Presented_proposal_for_next_contract__c::varchar)) between 401 and 700 then 1000 when max(length(Presented_proposal_for_next_contract__c::varchar)) between 701 and 1700 then 2000 when max(length(Presented_proposal_for_next_contract__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Presented_proposal_for_next_contract__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Presented_proposal_for_next_contract__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Presented_proposal_for_next_contract__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Presented_proposal_for_next_contract__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Presented_proposal_for_next_contract__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Presented_proposal_for_next_contract__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Presented_proposal_for_next_contract__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Presented_proposal_for_next_contract__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Presented_proposal_for_next_contract__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Presented_proposal_for_next_contract__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 127 "position", 'Reviewed_delinquency_status__c' column_name, count(1) cnt, max(length(Reviewed_delinquency_status__c::varchar)) max_col_len, case when max(length(Reviewed_delinquency_status__c::varchar)) < 20 then 20 when max(length(Reviewed_delinquency_status__c::varchar)) between 21 and 40 then 50 when max(length(Reviewed_delinquency_status__c::varchar)) between 41 and 70 then 100 when max(length(Reviewed_delinquency_status__c::varchar)) between 71 and 200 then 250 when max(length(Reviewed_delinquency_status__c::varchar)) between 201 and 400 then 500 when max(length(Reviewed_delinquency_status__c::varchar)) between 401 and 700 then 1000 when max(length(Reviewed_delinquency_status__c::varchar)) between 701 and 1700 then 2000 when max(length(Reviewed_delinquency_status__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Reviewed_delinquency_status__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Reviewed_delinquency_status__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Reviewed_delinquency_status__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Reviewed_delinquency_status__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Reviewed_delinquency_status__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Reviewed_delinquency_status__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Reviewed_delinquency_status__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Reviewed_delinquency_status__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Reviewed_delinquency_status__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Reviewed_delinquency_status__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 128 "position", 'Secured_next_contract__c' column_name, count(1) cnt, max(length(Secured_next_contract__c::varchar)) max_col_len, case when max(length(Secured_next_contract__c::varchar)) < 20 then 20 when max(length(Secured_next_contract__c::varchar)) between 21 and 40 then 50 when max(length(Secured_next_contract__c::varchar)) between 41 and 70 then 100 when max(length(Secured_next_contract__c::varchar)) between 71 and 200 then 250 when max(length(Secured_next_contract__c::varchar)) between 201 and 400 then 500 when max(length(Secured_next_contract__c::varchar)) between 401 and 700 then 1000 when max(length(Secured_next_contract__c::varchar)) between 701 and 1700 then 2000 when max(length(Secured_next_contract__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Secured_next_contract__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Secured_next_contract__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Secured_next_contract__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Secured_next_contract__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Secured_next_contract__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Secured_next_contract__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Secured_next_contract__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Secured_next_contract__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Secured_next_contract__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Secured_next_contract__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 129 "position", 'Shared_customers_rating_and_reviews__c' column_name, count(1) cnt, max(length(Shared_customers_rating_and_reviews__c::varchar)) max_col_len, case when max(length(Shared_customers_rating_and_reviews__c::varchar)) < 20 then 20 when max(length(Shared_customers_rating_and_reviews__c::varchar)) between 21 and 40 then 50 when max(length(Shared_customers_rating_and_reviews__c::varchar)) between 41 and 70 then 100 when max(length(Shared_customers_rating_and_reviews__c::varchar)) between 71 and 200 then 250 when max(length(Shared_customers_rating_and_reviews__c::varchar)) between 201 and 400 then 500 when max(length(Shared_customers_rating_and_reviews__c::varchar)) between 401 and 700 then 1000 when max(length(Shared_customers_rating_and_reviews__c::varchar)) between 701 and 1700 then 2000 when max(length(Shared_customers_rating_and_reviews__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Shared_customers_rating_and_reviews__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Shared_customers_rating_and_reviews__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Shared_customers_rating_and_reviews__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Shared_customers_rating_and_reviews__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Shared_customers_rating_and_reviews__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Shared_customers_rating_and_reviews__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Shared_customers_rating_and_reviews__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Shared_customers_rating_and_reviews__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Shared_customers_rating_and_reviews__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Shared_customers_rating_and_reviews__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 130 "position", 'Completed_Touchpoint__c' column_name, count(1) cnt, max(length(Completed_Touchpoint__c::varchar)) max_col_len, case when max(length(Completed_Touchpoint__c::varchar)) < 20 then 20 when max(length(Completed_Touchpoint__c::varchar)) between 21 and 40 then 50 when max(length(Completed_Touchpoint__c::varchar)) between 41 and 70 then 100 when max(length(Completed_Touchpoint__c::varchar)) between 71 and 200 then 250 when max(length(Completed_Touchpoint__c::varchar)) between 201 and 400 then 500 when max(length(Completed_Touchpoint__c::varchar)) between 401 and 700 then 1000 when max(length(Completed_Touchpoint__c::varchar)) between 701 and 1700 then 2000 when max(length(Completed_Touchpoint__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Completed_Touchpoint__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Completed_Touchpoint__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Completed_Touchpoint__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Completed_Touchpoint__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Completed_Touchpoint__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Completed_Touchpoint__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Completed_Touchpoint__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Completed_Touchpoint__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Completed_Touchpoint__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Completed_Touchpoint__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 union all
SELECT *, case when datatype like 'varchar%' then 'e.' || column_name when datatype like 'boolean%' then 'e.' || column_name || '::boolean' when datatype like 'int%' then 'e.' || column_name || '::int' when datatype like 'numeric%' then 'e.' || column_name || '::numeric(18,4)' when datatype like 'timestamp%' then 'cast(e.' || column_name || ' as timestamp)' end merge_cast  from (SELECT table_name, "position", column_name, data_type current_datetype, is_true_false, max_col_len, case when is_not_null = 0 then 'Y' else 'N' end all_nulls, isnull(case when is_true_false > 0 and is_true_false >= is_string then 'boolean' when (is_date > 0 and is_date >= is_string) or (is_timestamp  > 0 and is_timestamp >= is_string) or (is_timestampz > 0 and is_timestampz >= is_string) then 'timestamp' when is_int > 0 and is_int >= is_string_special_char and is_int >= is_decimal and is_alphabet = 0 then 'int' when is_decimal > 0 and is_decimal >= is_string_special_char then 'numeric(18,4)' when is_string > 0 or is_string_special_char > 0 then 'varchar('|| data_length || ')' end, 'varchar(250)') datatype, case when cnt = is_not_null then ' not null' else '' end nullable, is_int, is_decimal, is_date, is_timestamp, is_timestampz, is_string, is_alphabet, is_string_special_char from ( SELECT 'tmp_xt2_sf_task' table_name, 'varchar(2000)' data_type, 131 "position", 'Disposition_Type__c' column_name, count(1) cnt, max(length(Disposition_Type__c::varchar)) max_col_len, case when max(length(Disposition_Type__c::varchar)) < 20 then 20 when max(length(Disposition_Type__c::varchar)) between 21 and 40 then 50 when max(length(Disposition_Type__c::varchar)) between 41 and 70 then 100 when max(length(Disposition_Type__c::varchar)) between 71 and 200 then 250 when max(length(Disposition_Type__c::varchar)) between 201 and 400 then 500 when max(length(Disposition_Type__c::varchar)) between 401 and 700 then 1000 when max(length(Disposition_Type__c::varchar)) between 701 and 1700 then 2000 when max(length(Disposition_Type__c::varchar)) between 1701 and 3500 then 4000 else 8000 end data_length, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Type__c,'^[a-zA-Z0-9_]*$')>0 then 1 end) is_string, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Type__c,'^.*[a-zA-Z].*$') > 0 then 1 end) is_alphabet, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Type__c,'[^a-zA-Z0-9\s]') >0 then 1 end) is_string_special_char, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Type__c,'^[0-9]*$') > 0 then 1 end) is_int, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Type__c,'(\+|-)?([0-9]+(\.[0-9]+))') > 0 then 1 end) is_decimal, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_date, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Type__c,'^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$') > 0 then 1 end) is_timestamp, COUNT(CASE WHEN REGEXP_COUNT(Disposition_Type__c,'^(\d{4}((-)?(0[1-9]|1[0-2])((-)?(0[1-9]|[1-2][0-9]|3[0-1])(T(24:00(:00(\.[0]+)?)?|(([0-1][0-9]|2[0-3])(:)[0-5][0-9])((:)[0-5][0-9](\.[\d]+)?)?)((\+|-)(14:00|(0[0-9]|1[0-3])(:)[0-5][0-9])|Z))?)?)?)$')>0 then 1 end) is_timestampz, COUNT(CASE WHEN lower(Disposition_Type__c) in ('true','false') then 1 end ) is_true_false, COUNT(CASE WHEN Disposition_Type__c is not null then 1 end ) is_not_null from ext.tmp_xt2_sf_task) x limit 100000) x2 
) x1;

select * from tmp.sfdc_event_meta;

select /*+Direct*/ * into tmp.sfdc_event_meta_viren from tmp.sfdc_event_meta;


--drop table tmp.sfdc_event_meta;


select case when datatype like 'varchar%' then column_name
when datatype like 'int%' then column_name || '::int'
when datatype like 'numeric%' then column_name || '::numeric(18,4)'
when datatype like 'timestamp%' then 'cast(' || column_name || ' as timestamp)' end, *
from tmp.sfdc_event_meta
;

select export_objects('','ypa.d_sfdc_event');


select count(1) From ext.tmp_xt2_sf_event
limit 10;

--3146010

select count(1) From ext.tmp_xt2_sf_task
limit 10;

--14147807

select meta_query from dev.meta_col_datatype_v2 where table_name  = 'tmp_xt2_sf_task';

select export_objects('','ext.tmp_xt2_sf_task');

